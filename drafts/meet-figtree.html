<!DOCTYPE html>
<html lang="en">

  <head>
      <meta name="viewport" content="width=device-width, intial-scale=1" />

      <title>Johz</title>
      <link href='//fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,400,600,700' rel='stylesheet' type='text/css' />
      <link href='//fonts.googleapis.com/css?family=Merriweather:300' rel='stylesheet' type='text/css'/>
      <link href='//fonts.googleapis.com/css?family=Source+Code+Pro:200,400,700' rel='stylesheet' type='text/css'/>
      <link rel="stylesheet" type="text/css" href="http://www.johz.me/theme/css/icons.css"/>
      <link rel="stylesheet" type="text/css" href="http://www.johz.me/theme/css/styles.css"/>
      <meta charset="utf-8" />
  </head>

  <body id="index">
    <!-- header -->
    <header class="siteheader">
      <div class="siteheader-cell">
        <div class= "sitetitle">
          <a class="nodec emph" href="http://www.johz.me">
            Johz
          </a>
        </div>
      </div>
      <div class="siteheader-cell">
        <div class = "sitebanner">
          <h3 class ="sitesubtitle">  <script>
    quotes = [
        "The blog that's always right, for an entirely arbitrary value of&nbsp;'right'.",
        "Disclaimer: I have no idea what I'm doing']&lt;&amp;#47;div&gt;); DROP TABLE&nbsp;*;",
        "Currently working towards being 100% <a href='http://xkcd.com/1271'>XKCD/1271</a>&nbsp;compliant.",
        "More than just a blog, it's a way of&nbsp;life.",
        "- zen -",
        "This div container is left deliberately&nbsp;blank.",
        "<a href='https://github.com/MrJohz'>Fork me on GitHub!</a>  Fix an issue with Johz&nbsp;today!",
        "Proud Fenda Scum",
        "If you're reading this, the resistance is ready to march.  Send the signal via the usual channels.  Glory to the Great&nbsp;Cause!",
        "This is not the blog.  The blog is down there.<br/>Stop looking at this.  It's getting weird&nbsp;now.",
    ]

    index = Math.floor(Math.random() * quotes.length);
    document.write(quotes[index])
  </script>
  <noscript>
    Currently working towards being 100% <a href='http://xkcd.com/1271'>XKCD/1271</a>&nbsp;compliant.
  </noscript>
</h3>
          <!-- nav -->
          <nav class="menu">
            <ul>
              <!-- menu items-->
              <!--pages-->
              <!-- services icons -->
            </ul>
          </nav>
        </div> <!-- sitebanner -->
      </div>
    </header>

    <!-- content -->

<section class="content">

  <h3 class="posttitle">
    <a class="nodec" href="/drafts/meet-figtree.html" rel="bookmark" title="Permalink to Meet Figtree">
      Meet Figtree
    </a>
  </h3>

  <div class="postinfo">
    <p class="published" title="2015-09-19T12:26:20+01:00">
      Sat 19 September 2015
    </p>

  </div><!-- .postinfo -->

  <div class="article">
    <p>You know sometimes you do a stupid thing and it turns out to be so much more fun than doing the sensible thing that you really can't seem to shake it?</p>
<p>Meet figtree, my latest stupid thing.</p>
<div class="highlight"><pre><span class="nx">figtree_is</span> <span class="p">{</span>
    <span class="s2">&quot;noded&quot;</span><span class="o">:</span> <span class="s2">&quot;configuration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;it looks&quot;</span><span class="o">:</span> <span class="s2">&quot;a bit like JSON&quot;</span><span class="p">,</span>

    <span class="nx">except</span> <span class="p">{</span>
        <span class="s2">&quot;for&quot;</span><span class="o">:</span> <span class="s2">&quot;these random blocks everywhere&quot;</span>

        <span class="c1">// plus a few other details, not least the fact that, what with comments and</span>
        <span class="c1">// everything, it&#39;s actually somewhat readable without too much effort.</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Figtree, as the example says, is a noded configuration file format.  By "noded", I mean that it allows configuration values to sorted into sections ("nodes"), and ensures that those nodes are syntactically distinct from simple nested data.  As a configuration file format, as opposed to a general data format, I tried to make it expressive and easy-to-read, on the basis that the people who might actually need to read and write figtree files should be able to pick it up and use it easily.</p>
<p>Nodes are made up from an identifier and a brace block, so they look a lot like function definitions or block structures in most C-like languages.  Identifiers use the same rules as Swift, because I liked the idea of emoji winding everyone up all the time, but mainly because those rules seemed fairly sane.</p>
<blockquote>
<p><strong>Rules of Swift</strong>:
Identifiers begin with an uppercase or lowercase letter A through Z, an underscore (_), a noncombining alphanumeric Unicode character in the Basic Multilingual Plane, or a character outside the Basic Multilingual Plane that isnâ€™t in a Private Use Area. After the first character, digits and combining Unicode characters are also allowed.</p>
</blockquote>
<p>On the basis that there may be some circumstances where that wasn't enough, it's also possible to use arbitrary strings as identifiers, by enclosing them with <code>`backticks`</code>.  These "quoted idents" can't contain raw newlines (although you can include newlines using <code>\n</code> if you need), but otherwise follow the same rules for strings.</p>
<p>Nodes can contain subnodes, but they can also contain key-value pairs known as "attributes".  In figtree, keys are <em>always</em> strings.  This is a limitation, but I suspect there aren't many circumstances where non-key strings are needed.  Using only strings makes the resultant structure much easier to use in statically-typed languages, and also significantly simpler to parse.</p>
<p>Attribute pairs must be separated by commas, and may optionally (i.e. almost always should) have a trailing comma at the end.  You don't need a comma between an attribute and a node, and you can't have a comma after a node (much like how you don't have semicolons after brace-blocks in most braced languages).</p>
<p>Values are either simple, or complex.  Simple values are strings, integers, floats, booleans, and identifiers, while complex values are lists and dicts, that contain sub-values inside them.</p>
<p>Strings are roughly like JSON strings, except for a few of features.  Firstly, they are multiline by default, as opposed to JSON strings which can only include newlines using the escape sequence <code>\n</code>.  Secondly, they can use either single (<code>'</code>) or double (<code>"</code>) quotes.  Thirdly, all the rules for JSON strings can be liberally ignored using raw strings, which are strings that are preceded by the letter <code>r</code>, as in <code>r"this is a raw string"</code>.  Raw strings use both the standard quote characters, but can also use <code>/slashes/</code>, <code>$dollar signs$</code>, <code>%percent signs%</code>, <code>|pipe signs|</code>, <code>#hashes#</code>, or <code>(brackets)</code>.  Inside raw strings, no backslash-escapes can be used.  To allow for the use of the quote character inside a raw string, it's possible to repeat the number of quote characters multiple times, and the string will only close when the same number of quote characters happens again in sequence.  For example, <code>r$$$this string can contain up to two $ signs ($$) because the outer quote uses three signs$$$</code> will be parsed as one string.</p>
<p>For string values (although not for keys) whenever multiple strings are found with no separator, they will be concatenated (as in Python).  This makes it possible to write relatively long prose without having to worry about excess whitespace.</p>
<p>Integers are fairly simple, they can either be the standard decimal, optionally preceded by a positive or negative sign, or a hexadecimal, octal, decimal, or binary number, preceded by a <code>0x</code>, <code>0o</code>, <code>0d</code>, or <code>0b</code> respectively.</p>
<p>Floats, likewise, follow fairly standard rules.  There must be at least one decimal point and at least one integer on one side or the other of that point.  There can be a sign at the start, and an exponent at the end.</p>
<div class="highlight"><pre><span class="n">root_node {</span>
    <span class="err">&quot;keys&quot;:</span> <span class="err">&quot;must</span> <span class="err">always</span> <span class="err">be</span> <span class="err">strings&quot;,</span>
    <span class="err">&quot;values&quot;:</span> <span class="err">&quot;can</span> <span class="err">be</span> <span class="err">a</span> <span class="err">lot</span> <span class="err">of</span> <span class="err">things&quot;,</span>

    <span class="n">value_types {</span>
        <span class="err">&quot;list&quot;:</span> <span class="err">[&#39;contains&#39;,</span> <span class="err">&#39;individual&#39;,</span> <span class="err">&#39;values&#39;],</span>
        <span class="err">&quot;dict&quot;:</span> <span class="err">{&#39;basic&#39;:</span> <span class="err">&#39;mapping&#39;},</span>  <span class="c">// both container types can be nested</span>
        <span class="err">&quot;string&quot;:</span> <span class="err">[</span>
            <span class="err">&quot;double</span> <span class="err">quotes&quot;,</span>
            <span class="err">&#39;single</span> <span class="err">quotes&#39;,</span>
            <span class="err">&quot;quotes&quot;</span> <span class="err">&quot;together&quot;</span> <span class="err">&quot;are&quot;</span> <span class="err">&#39;concatenated&#39;,</span>
            <span class="err">&quot;quotes</span>
            <span class="err">can</span> <span class="err">contain</span> <span class="err">newlines&quot;</span>
            <span class="err">r/raw</span> <span class="err">string/,</span> <span class="c">/* can also use &#39;&quot;|$%() */</span>
            <span class="err">r$$use</span> <span class="err">multiple</span> <span class="err">quote</span> <span class="err">characters</span> <span class="err">to</span> <span class="err">contain</span> <span class="err">$</span> <span class="err">quotes$$,</span>
        <span class="err">],</span>
        <span class="err">&quot;integer&quot;:</span> <span class="err">[</span>
            <span class="err">+394,</span> <span class="err">-343,</span> <span class="c">/* standard decimal */</span>
            <span class="err">0xDEADBEEF,</span> <span class="c">/* hexadecimal*/</span>
            <span class="err">0d444,</span> <span class="c">/* nonstandard decimal */</span>
            <span class="err">0b0100_0110,</span> <span class="c">/* binary, note all integers can contain underscores */</span>
            <span class="err">0o34,</span> <span class="c">/* octal */</span>
        <span class="err">],</span>
        <span class="err">&quot;float&quot;:</span> <span class="err">[</span>
            <span class="err">34.53,</span> <span class="err">+34.53,</span> <span class="err">-34.53,</span> <span class="c">/* bog standard */</span>
            <span class="err">34.,</span> <span class="err">.53,</span> <span class="c">/* leave bits off */</span>
            <span class="err">34e-34,</span> <span class="c">/* and e-notation */</span>
        <span class="err">],</span>
        <span class="err">&quot;boolean&quot;:</span> <span class="err">[</span>
            <span class="err">true,</span> <span class="err">false,</span> <span class="c">/* only lowercase, only these two literals allowed */</span>
        <span class="err">],</span>
        <span class="err">&quot;identifiers&quot;:</span> <span class="err">[</span>
            <span class="err">!hjef,</span> <span class="c">/* follow the same rules as identifiers for nodes */</span>
            <span class="err">!includes_underscores,</span> <span class="c">/* but always preceded by a &#39;!&#39; token */</span>
            <span class="err">!`can</span> <span class="err">have</span> <span class="err">quoted</span> <span class="err">idents`,</span> <span class="c">/* uses same escaping as strings, but can&#39;t contain newlines */</span>
        <span class="err">]</span>
    <span class="err">}</span>
<span class="err">}</span>
</pre></div>


<h2>Okay, better question, why does it exist?</h2>
<p>Figtree is designed especially for configuration files.  A lot of configuration involves nested hierachies, groups and subgroups.  For example, a configuration dealing with a particular web application might need to contain the ports and addresses to run the server on, the connection details for the databases it needs to connect to,</p>
  </div><!-- .content -->

</section>


    <!-- footer -->
    <footer>
      <p>
        Â© Jonathan Frere, license <a href=""> </a>
        unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a> with
        <a href="http://github.com/porterjamesj/crowsfoot">crowsfoot</a> theme.
      </p>
    </footer>
  </body>
</html>