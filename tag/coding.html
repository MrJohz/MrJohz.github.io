<!DOCTYPE html>
<html lang="en">

  <head>
      <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />


  <script type="text/javascript">
  themes = [
    'dark',
    'light',
  ];
      themeDefault = "dark";
  </script>

  <script type="text/javascript">
    window.themeSwitcher=new function(e,t){"use strict";var n=function(e,t,n){if(Array.prototype.indexOf){return Array.prototype.indexOf.apply(e,Array.prototype.slice.call(arguments,1))}var r,i=n?n:0,s;s=e.length;if(s===0||i>=s){return-1}if(i<0){i=s-Math.abs(i)}for(r=i;r<s;r++){if(e[r]==t){return r}}return-1};var r="pillbox-theme-tester-value";var i="pillbox-theme";var s=this;s.lsExists=false;s.themes=e;s.defaultTheme=n(e,t);s.currentTheme=s.defaultTheme;try{localStorage.setItem(r,r);if(localStorage.getItem(r)===r){localStorage.removeItem(r);s.lsExists=true}}catch(o){}var u=function(e){if(e>=0&&e<s.themes.length){return{s:s.themes[e],i:e}}else{return{s:s.themes[s.currentTheme],i:s.currentTheme}}};var a;if(s.lsExists){var f=localStorage.getItem(i);s.currentTheme=n(e,f);if(s.currentTheme<0){s.currentTheme=s.defaultTheme}a=function(e){var t=u(e);var n=document.getElementById("main-theme");var r=n.href.split("/");r[r.length-1]=t.s+".min.css";n.href=r.join("/");localStorage.setItem(i,t.s);s.currentTheme=t.i}}else{a=function(e){var t=u(e);var n=document.getElementById("main-theme");var r=n.href.split("/");r[r.length-1]=t.s+".min.css";n.href=r.join("/");s.currentTheme=t.i}}s.writeStyle=function(){var e=s.themes[s.currentTheme];document.write('<link id="main-theme" href="https://mrjohz.github.io/theme/css/');document.write(e+'.min.css" rel="stylesheet" />')};s.getStyle=function(e){if(e==null||typeof e==="undefined"){return s.currentTheme}else if(typeof e==="number"&&e===Math.floor(e)){return u(t).s}else{var t=n(s.themes,e);if(t>-1){return t}else{return s.currentTheme}}};s.setStyle=function(e){var t=s.getStyle(e);if(t==s.currentTheme){return}a(t)};s.cycleStyle=function(){console.log(s.currentTheme);a((s.currentTheme+1)%s.themes.length)};s.addSwitcher=function(e){var t=document.getElementById(e);var n=document.createElement("select");n.id="theme-switcher-select";for(var r=0;r<s.themes.length;r++){var i=s.themes[r];var o=document.createElement("option");o.value=i;o.appendChild(document.createTextNode(i));if(r==s.currentTheme){o.selected=true}n.appendChild(o)}n.onchange=function(){var e=this.options[this.selectedIndex].value;themeSwitcher.setStyle(e)};t.appendChild(n)};s.addCycleButtons=function(){var e=document.querySelectorAll("a[href='#cycle-themes']");for(var t=0;t<e.length;t++){var n=e[t];n.addEventListener("click",function(e){e.preventDefault();s.cycleStyle()})}}}(themes,themeDefault)

    themeSwitcher.writeStyle();
  </script>
  <noscript>
    <link id="main-theme" href="https://mrjohz.github.io/theme/css/dark.min.css" rel="stylesheet" />
  </noscript>

      <title>  Johz - coding
</title>

  <link href="https://mrjohz.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Johz Full Atom Feed" />

  </head>

  <body>
    <header id="header">
      <h1 id="header-title"><a class="no-hilite" href="https://mrjohz.github.io/">
        <div id="sitename">Johz</div>
      </a></h1>
    </header>

      <nav id="menu"><ul>


          <li><a href="#cycle-themes">Change Theme</a></li>

            <li  ><a href="https://mrjohz.github.io/pages/about-me.html">About&nbsp;Me</a></li>



      </ul></nav>


<!-- Random quote on index page -->
  <script>
    quotes = [
        "The blog that's always right, for an entirely arbitrary value of 'right'.",
        "Disclaimer: I have no idea what I'm doing']&lt;&amp;#47;div&gt;); DROP TABLE *;",
        "Currently working towards being 100% <a href='http://xkcd.com/1271'>XKCD/1271</a> compliant.",
        "More than just a blog, it's a way of life.",
        "- zen -",
        "This div container is left deliberately blank.",
        "<a href='https://github.com/MrJohz'>Fork me on GitHub!</a>  Fix an issue with Johz today!",
        "Proud Fenda Scum",
        "Try this site in a <a href='#theme-switcher'>different theme</a>.",
        "Built with the three 'P's, <a href='http://getpelican.com/'>Pelican</a>, <a href='http://python.org/'>Python</a>, and <a href='https://github.com/MrJohz/pillbox-theme'>Pillbox</a>.",
    ]

    index = Math.floor(Math.random() * quotes.length);
    document.writeln("<div id='quote'>")
    document.writeln("    " + quotes[index])
    document.writeln("</div>")
  </script>

<section id="content">
  <h2 id="content-title">Articles with the coding tag</h2>
    <article class="blog-article">

      <header class="article-header">
        <h2 class="entry-title">
          <a href="https://mrjohz.github.io/posts/2015/Apr/15/python-in-python/" class="no-hilite" rel="bookmark" title="Permalink to Writing Python inÂ Python">
            Writing Python in&nbsp;Python
          </a>
        </h2>
      </header>
      <footer class="article-footer">
        Published <abbr class="published" title="2015-04-15T11:50:00+01:00"> Wed 15 April 2015 </abbr>
          by <a href="https://mrjohz.github.io/author/johz.html">Johz</a>
      </footer>

      <div class="article-text">
        <p>Python was my first programming language.  Some time around the age of sixteen or
seventeen, I got it into my head that I should learn a programming language, and one thing
lead to another, and I ended up working through Swaroop&#8217;s <a href="http://www.swaroopch.com/notes/python/">A Byte of Python</a>, and
then Sande <span class="amp">&amp;</span> Sande&#8217;s <a href="http://www.manning.com/sande/">Hello World</a>.  The latter was particularly good,
and I learned a lot of stuff, and, alongside most new programmers, I loved getting my
computer to do things that I&#8217;d told it to&nbsp;do.</p>
<p>That said, Python didn&#8217;t excite me.  Programming was cool, and new, and fun, but Python
itself was, well, the tool I used.  And a fairly standard tool at that.  What changed
was <a href="http://corepython.com/">Core Python Programming</a>.  (Yes, this is basically book review corner,
I&#8217;ll get to the more interesting stuff in a minute&#8230;)  Core Python, despite being
somewhat out-of-date at this point (although it does include notes on pre-announced 2.6
features, and a couple of paragraphs on how Python will slowly be transitioning to
&#8220;Python 3000&#8221;, which I&#8217;m sure if very exciting news for all of us!) was a particularly
good book at describing Python, rather than just programming.  Which finally brings us
on to the first bit of code that made me feel really excited about <em>Python</em>.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyNumber</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MyNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_num</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">my_num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;MyNumber(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_num</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
</pre></div>


<p>What&#8217;s so special about these two lines?  Well, this is a method inside a user-defined
class in Python.  More specifically, it&#8217;s a &#8220;magic method&#8221;, or dunder method (dunder as
in double underscore) that is called when the addition operator is used on the defined
class.  It allows the user of this class to write code that looks like&nbsp;this:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">MyNumber</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">MyNumber</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>  <span class="c"># MAGIC!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">my_num</span>
<span class="go">15</span>
</pre></div>


<p>To me, however, this was my first chance to break open Python and write&nbsp;inside.</p>
<p>You see, Python is written in Python.  This is an almost entirely untrue statement, so I
probably ought to explain myself first.  I&#8217;m not talking about the interpreter, which for
most people is written in C.  No, I&#8217;m talking about the language itself.  The language
&#8220;Python&#8221; is written in&nbsp;Python.</p>
<p>This statement is only somewhat untrue.  That&#8217;s a start!  Here&#8217;s an&nbsp;example.</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">MyNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">__add__</span>
<span class="go">&lt;method-wrapper &#39;__add__&#39; of int object at 0x829c1c0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">__add__</span>
<span class="go">&lt;bound method MyNumber.__add__ of MyNumber(3)&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">MyNumber</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">MyNumber(10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">+</span> <span class="n">MyNumber</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">MyNumber(10)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="s">&quot;string&quot;</span>  <span class="c"># Python doesn&#39;t do automatic coercion, remember!</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand type(s) for +: &#39;int&#39; and &#39;str&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="s">&quot;string&quot;</span><span class="p">)</span>  <span class="c"># Surely this should do the same thing?</span>
<span class="go">NotImplemented</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">+</span> <span class="s">&quot;string&quot;</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">5</span>, in <span class="n">__add__</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;my_num&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="s">&quot;string&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">5</span>, in <span class="n">__add__</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;my_num&#39;</span>
</pre></div>


<p>The most interesting bits here are the differences between the built-in int operations,
and the custom MyNumber class operations.  Here&#8217;s each one in&nbsp;turn:</p>
<p>Firstly, in Python 3, classes have functions attached to them.&nbsp;Instances</p>
      </div>

        <hr class="article-divider">

    </article>
    <article class="blog-article">

      <header class="article-header">
        <h2 class="entry-title">
          <a href="https://mrjohz.github.io/posts/2015/Jan/17/get-benched/" class="no-hilite" rel="bookmark" title="Permalink to A Collection of Benchmarks that I FoundÂ Useful">
            A Collection of Benchmarks that I Found&nbsp;Useful
          </a>
        </h2>
      </header>
      <footer class="article-footer">
        Published <abbr class="published" title="2015-01-17T12:02:32+00:00"> Sat 17 January 2015 </abbr>
          by <a href="https://mrjohz.github.io/author/johz.html">Johz</a>
      </footer>

      <div class="article-text">
        <p>As Donald Knuth once explained, 97% of a programmer&#8217;s time should be spent making their code as fast as possible.  (The other 3% is waiting for the code to compile.)  Most programmers have a host of shortcuts, tricks, and clever codes up their sleeves to ensure that their code runs as fast as it possibly can.  For example, in JavaScript, many developers have spent years studying the secret arts of the for-loop to determine how to loop through arbitrary numbers most quickly.  (The answer to this particular question is actually an inverse-backwards while-never-done-loop, where the first character on each line is an &#8216;a&#8217;, and where the programmer chants hymns worshipping Azathoth.)  The faster their code works, the more web-scale their <del>node.js</del> io.js programs will&nbsp;be.</p>
<p>There are lots of myths, legends, and rumours about optimization, and it&#8217;s often very difficult to sort out the truth from the lies.  However, to help us in our quest for absolute speed, good programmers should always use benchmarks.  Benchmarks are a way of comparing like-for-like speeds of two programs, each containing different ways of doing the same thing, to determine which method is the quickest, and should therefore be used in all circumstances.  Of course, true benchmarks are often extremely difficult, and so programmers are often forced to compare unlike-for-unlike.  However, the major differences between like-for-like and unlike-for-unlike are usually negligible, and so a good programmer can almost always simplify a complex comparison into a very straight race between two arbitrary pieces of code, and interpret the results correctly.  This simplification is done in much the same way that a physicist simplifies complex problems to simple ones using spherical cows in a&nbsp;vacuum.</p>
<h3>The Importance of&nbsp;Whitespace</h3>
<p>The first misconception that many programmers have is that whitespace makes no difference.  While in most cases, good compilers can optimize away whitespace, and sometimes even remove it entirely from the resulting binary, it can still make a large difference to compile-times, and as programmers need to spend at least 97% of their time optimising, decreasing the length of time that a programmer needs to wait to compile a program is always a good thing.  Of course, this is to say nothing of interpreted programs, where there is no compilation stage, and so the whitespace cannot ever be optimized away, and must remain during the final execution of the&nbsp;program.</p>
<p>The best way to demonstrate this is with a benchmark.  Consider the programs fast.c and slow.c (these are available on Github <a href="https://github.com/MrJohz/benchmarks/tree/master/whitespace">here</a>, although I would encourage you not to actually open slow.c unless you like dealing with very large text files).  They both do the same thing - print out &#8220;Hello, World!&#8221;.  However, they have radically different compile times because of the amount of whitespace involved.  If we run the <code>make</code> command, we can get the output, which includes timings of individual portions as performed by <code>gcc</code>.</p>
<div class="highlight"><pre><span class="gp">$</span> make
<span class="go">Fast implementation (no whitespace)</span>
<span class="go">wc -c fast.c</span>
<span class="go">104 fast.c</span>
<span class="go">gcc -time fast.c</span>
<span class="gp">#</span> cc1 0.02 0.00
<span class="gp">#</span> collect2 0.02 0.00

<span class="go">Slow implementation (some whitespace)</span>
<span class="go">wc -c slow.c</span>
<span class="go">86124463 slow.c</span>
<span class="go">gcc -time slow.c</span>
<span class="gp">#</span> cc1 0.18 0.04
<span class="gp">#</span> collect2 0.02 0.00
</pre></div>


<p>Here it is very easy to see that having to parse 83 thousand times the amount of bytes actually made the second implementation slightly slower to compile!  This is of huge importance in our files.  While we may not always notice the speed difference in our day-to-day programming experience, it is always good practice to use as little whitespace as possible when writing programs.  As I mentioned earlier, this applies to both compiled programs and interpreted programs, although the difference for the latter is much greater, as the performance hit will actually occur during runtime.  What you may not know (and what hasn&#8217;t been demonstrated here, but is left as an exercise to the reader) is that this also applies to comments as well - this is in fact the main reason for the &#8220;self-documenting code&#8221; movement, as repeating the documentation both in the code itself, and in comments alongside the code, is known to slow down character-by-character file input by as much as 200% (for perfectly balanced code/comment&nbsp;combinations).</p>
<h3>Interpreted vs&nbsp;Compiled</h3>
<p>Another important area of concern for programmers is the debate between interpreted languages and compiled languages.  Essentially, interpreted programming languages do all of the work when they are run, whilst compiled programming languages do some work at compile-time, and some work at runtime.  This would suggest that compiled programming languages are generally faster when being run, as they have to do less work at runtime.  The issue with this naive understanding of programming is that it doesn&#8217;t take into account the amount of work done at compile-time.  Proper benchmarking should include all stages of a program&#8217;s execution, even the stages before it&#8217;s actually started to&nbsp;execute.</p>
<p>There is also a middle ground between compiling a programming and directly interpreting a program.  Many modern interpreters are actually &#8220;<span class="caps">JIT</span>&#8221; compilers, which do both compilation and interpretation at the same time, at runtime.  While they still have to do all of the work at runtime, they are able to do extra work making other parts of the program take less work.  The aim is that eventually the amount of work that is saved will be greater than the amount of extra work that is required, but it is doubtful if this will ever happen.  Many computer experts believe that <span class="caps">JIT</span> compilers will remain in the realm of fantasy and academia for many years to come.  However, in the interests of fairness, we will also use a <span class="caps">JIT</span> compiler in our&nbsp;benchmarking.</p>
<p>Our test will be a simple &#8220;Hello, World!&#8221; example - that is, all three programs (compiled, interpreted and <span class="caps">JIT</span>-interpreted) should simply print out the phrase &#8220;Hello, World!&#8221;.  While this is generally an extremely simple task, we will easily be able to extrapolate from the results any conclusion that we would like to draw.  The programming languages that we shall use will be C++ (compiled using &#8220;g++ (Ubuntu 4.8.2-19ubuntu1) 4.8.2&#8221;, whatever that means); Python (interpreted using &#8220;CPython 3.4.2&#8221;); and Python again (this time <span class="caps">JIT</span> compiled using &#8220;Python 3.2.5&#8221;).  As we said previously, a good benchmark should compare all parts of a program&#8217;s lifetime, so we will measure the length of time it takes the C++ program to compile, as well as the execution time for all the programs.  As in the previous test, the test-code is available on <a href="https://github.com/MrJohz/benchmarks/tree/master/int-comp">GitHub</a>.</p>
<div class="highlight"><pre><span class="gp">$</span> make
<span class="go">C++ version</span>
<span class="go">../benchmarker.py -n20 &quot;g++ helloworld.c -ohelloworld &amp;&amp; ./helloworld&quot;</span>

<span class="go">------------------------------ </span>
<span class="go">   g++ helloworld.c -ohelloworld &amp;&amp; ./helloworld</span>
<span class="go"> max/min:    0.07519780099755735     0.053425493999384344</span>
<span class="go"> mean ave:   0.06308976999989682</span>
<span class="go"> median ave:     0.06266852850058058</span>
<span class="go">------------------------------</span>
<span class="go">CPython version</span>
<span class="go">../benchmarker.py -n20 &#39;python -c &quot;print(\&quot;Hello, World\&quot;)&quot;&#39;</span>

<span class="go">------------------------------ </span>
<span class="go">   python -c &quot;print(\&quot;Hello, World\&quot;)&quot;</span>
<span class="go"> max/min:    0.0267868869996164      0.023469741001463262</span>
<span class="go"> mean ave:   0.02465028059996257</span>
<span class="go"> median ave:     0.02490398199915944</span>
<span class="go">------------------------------</span>
<span class="go">PyPy version</span>
<span class="go">../benchmarker.py -n20 &#39;pypy -c &quot;print(\&quot;Hello, World\&quot;)&quot;&#39;</span>

<span class="go">------------------------------ </span>
<span class="go">   pypy -c &quot;print(\&quot;Hello, World\&quot;)&quot;</span>
<span class="go"> max/min:    0.22487263600123697     0.16340099499939242</span>
<span class="go"> mean ave:   0.20837249334999797</span>
<span class="go"> median ave:     0.21045488100025977</span>
<span class="go">------------------------------</span>
</pre></div>


<p>The statistics here are extremely clear - interpreted programs actually run faster than compiled programs, if you include the compilation time.  What is interesting - albeit not necessarily unexpected - to note is that the pypy attempt took on average nearly ten times as long as the CPython attempt.  As I said earlier, <span class="caps">JIT</span> compilers are very much in the realm of academia currently, and we are unlikely to see one of these outperform a proper programming language implementation in the next&nbsp;decade.</p>
<p>While not specifically tested in this particular test, it&#8217;s also important to note that both of the Python programs were significantly shorter than the C++ program, and could indeed be sent to the interpreter as a single line.  On the other hand, the C++ program had to be written in a separate file, and even the command itself had more text on it.  The upshot of this is that the C++ program contains more whitespace - of course, in this benchmark that probably isn&#8217;t a huge factor, but experience programmers should be wise to the fact that Python&#8217;s terseness often offers a not insignificant speed&nbsp;bonus.</p>
<h3>Direct&nbsp;Comparison</h3>
<p>Of course, these are just specific features of individual programming languages that we have been comparing so far.  In many cases, we want to know how the overall program would perform in a real-life situation.  This will often require large and extensive benchmarks that compare a number of different programming languages.  One of the big pitfalls that many of these benchmarks fail to avoid is the use of idiomatic programming features.  In most languages, there is a &#8220;right&#8221; way to do things and a &#8220;wrong&#8221; way to do things.  For example, the Java <span class="caps">JVM</span> is extremely versatile when it comes to loops, as it can make these run as efficiently as possible.  However, many Java users fail to realise this, and there is a lot of lost potential in many Java programs.  For example, most naive Java users would write a method that adds two numbers like&nbsp;so:</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">slowAdd</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<p>In actual fact, idiomatic Java would look much more like&nbsp;this.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">fastAdd</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">result</span><span class="o">++;</span>
    <span class="o">}</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">b</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">result</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<p>This will work much faster, due to the <span class="caps">JVM</span>&#8217;s affinity for looping&nbsp;constructs.</p>
<p>Of course, the differences between programming languages often goes a lot further than the best way to add different numbers together.  Most programming languages were designed for completely different purposes, and as a result testing them all in exactly the same way is usually the wrong way to do benchmarks.  Instead, the challenges given to each programming languages (and the method used to complete the challenge) should be specifically designed for each programming language.  Of course, to maintain independence, each programming language should be measured in exactly the same way, otherwise the results would be&nbsp;incomparable.</p>
<p>In our comparison, we&#8217;ll test Python, Java, and Perl, attempting to write the most idiomatic code possible to ensure that each language has the best possible chance.  The source code for this test will not be on GitHub, as anyone fluent in these languages should be writing these things every day, and there really is no need to bombard you with thing that I&#8217;m sure you already&nbsp;know.</p>
<p>In our Python program, we will be attempting to write the most commonly written Python program, <code>print("Hello, World!")</code>.  Many people would question the use of such a basic test, but the huge number of people who demonstrate this piece of code as evidence of Python&#8217;s simplicity and versatility in all things cannot be called into question.  Ultimately, if you can write the Hello, World! Python program, you can write any piece of Python code at all, as long as it solely involve printing out a string.  As a result, this is the benchmark code I will&nbsp;use.</p>
<p>On the other hand, very serious people use Java to do very serious things, and so to trivialise the language to simply printing out a string would be to do the Java community a huge disservice.  Instead, our benchmark Java code will create a server, and wait indefinitely for a response.  This is basically the code that most Java experts write every day.  Unfortunately it will not be <em>truly</em> idiomatic Java, as that would require a huge number of Java classes that I honestly can&#8217;t be bothered to write just for the sake of a cheap shot, especially as it&#8217;s been done <a href="https://github.com/EnterpriseQualityCoding/FizzBuzzEnterpriseEdition">before</a>.  It is arguable that the Java code will be unable to stop, as it will hang forever until it receives a quit signal at the terminal.  To be honest, I think this just makes it more and more clear how slow idiomatic Java code is.  Also buggy.  Java code is probably buggy too.  It&#8217;s still cool to hate Java,&nbsp;right?</p>
<p>Finally, we have our Perl program.  Perl is designed to be as quick as possible, by omitting any extraneous necessities like readability.  No-one is quite sure what idiomatic Perl programs should actually do, as it is difficult to remember the exact invocation syntax for that Perl script you wrote several years ago that you&#8217;re quite sure did something with <span class="caps">XML</span> files, but you&#8217;re not really sure <em>what</em>.  Of course, you could just read the source, but to be honest it would probably be easier to rewrite the whole thing rather than dabble in that sort of black magic and&nbsp;wizardry.</p>
<p>It turns out that the idiomatic Perl program doesn&#8217;t actually work.  I&#8217;m 90% certain I wrote everything write, so I&#8217;m going to blame the Perl interpreter.  Perl is, after all, notoriously difficult to read, and everyone knows that computers are fairly&nbsp;stupid.</p>
<p><img alt="Basically, Python won.  Also Dumbledore dies at the end.  Spoiler." src="http://i.imgur.com/1kccxn5.png" /></p>
<p>In the end, it appears that Python won both of the benchmarks that it was involved in, compared to C, and also compared to Java and Perl.  A basic interpretation of these results would suggest that, when writing programs that print out &#8220;Hello, World!&#8221;, Python is extremely strong.  We can also quickly extrapolate from this that Python is probably the best language in the world for most of the world&#8217;s problems.  Thankfully, as a Python programmer, I have basically just proved exactly what I knew already - I mean, it would be a bit shocking if it suddenly turned out I&#8217;d been wrong,&nbsp;eh?</p>
<p>Thanks for reading this short, humble, but extremely accurate blog on proper benchmarking practice.  There are a lot of people on the internet who are producing very dangerous and misleading benchmarks, that encourage people down dangerous paths, such as trying silly languages, just because they appear to beat certain things on certain benchmarks.  As I have clearly shown here, there is a right way to interpret benchmark results, and a wrong way.  I encourage you to share this with your friends, family, and strangers that you meet on the street, and particularly with those who persist in producing irrelevant and silly benchmarks simply for the sake of&nbsp;comparison.</p>
<p>Python for&nbsp;life!</p>
      </div>

        <hr class="article-divider">

    </article>
    <article class="blog-article">

      <header class="article-header">
        <h2 class="entry-title">
          <a href="https://mrjohz.github.io/posts/2014/Dec/19/the-definitive-guide-to-copying-and-pasting-in-javascript/" class="no-hilite" rel="bookmark" title="Permalink to The Definitive Guide to Copying and Pasting in JavaScript (the otherÂ kindâ¦)">
            The Definitive Guide to Copying and Pasting in JavaScript (the other&nbsp;kind&#8230;)
          </a>
        </h2>
      </header>
      <footer class="article-footer">
        Published <abbr class="published" title="2014-12-19T20:54:32+00:00"> Fri 19 December 2014 </abbr>
          by <a href="https://mrjohz.github.io/author/johz.html">Johz</a>
      </footer>

      <div class="article-text">
        <h2>Step 1:&nbsp;Don&#8217;t.</h2>
<p>Stop.  You don&#8217;t want flashing lights.  You don&#8217;t want snowflake all over your page.  You don&#8217;t want a trail of happy faces that will follow your cursor all around your page.  We left these things in decades past for a reason, dammit!  Keep them there, for all our sakes.  No copy and paste!  Ever!  No, no, no, no,&nbsp;no!</p>
<p><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></p>
<p>Well, yes, sometimes there is a reason to copy and paste text from the internet, particularly if you&#8217;re learning.  Sometimes you&#8217;re looking for a bit of advice on the perfect way to memoize some functions, or a quick and easy method to merge two objects, or even just a couple of basic string functions that you really wish had appeared in earlier EMCAScript specs.  In these cases, finding a quick &#8220;cookbook recipe&#8221; on the internet can be a great convenience.  Often, it&#8217;s a really good way for newer developers to expand their understanding of some of the language shortcuts.  The question then is &#8220;how should I best learn from this recipe?&#8221;  For you, then, comes step&nbsp;two.</p>
<h2>Step 2: Do it&nbsp;well.</h2>
<h3>Never copy-and-paste, always&nbsp;rewrite.</h3>
<p>I remember a book I once got given called <em>&#8220;Hello, World!&#8221;</em>, written by Sande <span class="amp">&amp;</span> Sande (a father and son duo).  It was a Python programming introduction for &#8220;Kids and other beginners&#8221;.  Fairly near the start, they gave a listing for a program that was certainly larger than anything that I&#8217;d seen up until that point that would let you play the classic skiing game where you have to ski down the mountain without hitting into things.  Of course, this being the technical age, they also provided a download for all the programs featured in the book, but this one came with a special&nbsp;note.</p>
<blockquote>
<p>The code for listing 10.1 is in the <code>\examples\skier</code> folder, so if you get stuck or just don&#8217;t want to type it all in, you can use that file.  But believe it or not, you&#8217;ll learn more by typing it in than by just opening and looking at the&nbsp;listing.</p>
</blockquote>
<p>So of course I typed the whole file in, and it came up with an error, because I wasn&#8217;t very good at coding, and didn&#8217;t understand what most of it actually did or meant<sup id="fnref:pythonfailure"><a class="footnote-ref" href="#fn:pythonfailure" rel="footnote">1</a></sup>.  However, I did start to piece together what the thing was actually meant to do.  I could read the names and the comments in the sidebar, and together I could get a feel for what sort of magic a line like <code>pygame.image.load(image_file)</code> might actually do.  (For the unitiated: it loads an image from an image file.  It&#8217;s part of the pygame system.  This is not hard stuff, but when you&#8217;re beginning it feels&nbsp;amazing&#8230;)</p>
<p>What <em>&#8220;Hello, World!&#8221;</em> had taught me in that small example was how to read code.  The way you read code is to go through each line individually.  This is probably not surprising for most well-practised developers, but in my various experiences of learning programming, reading code (and the sister-skill of thinking like a computer whilst doing so) are extremely&nbsp;under-taught.</p>
<p>This is the same when you are trying to use that useful function from the internet.  You <em>could</em> just copy and paste it.  That will work, and get you developing quickly, and you can go home, have a delicious dinner, watch some superb television, have the most beautiful dream, and then wake up next morning with everything going wrong because you didn&#8217;t quite understand that function you used, and it turns out it&#8217;s caught on an edge case that - as the case may be - is actually quite common in your&nbsp;circumstances.</p>
<p>Of course, that&#8217;s probably a rare example.  A lot of the functions that you paste are probably quite good, and will work quite well.  After all, StackOverflow is known for never ever being wrong ever.  However, it should always be on your mind that if you don&#8217;t understand the code you&#8217;re writing, it will always run the risk of jumping back at you and biting you.  When you write the function out, line-by-line, you&#8217;ll quickly start to understand what cases this will deal with, and what cases this won&#8217;t cope with.  You&#8217;ll be able to see what guards exist, what format the function will return, and whatever other features the original creator put in but didn&#8217;t&nbsp;document.</p>
<h3>Always change at least one&nbsp;thing.</h3>
<p>For me, this idea followed on quite easily from the previous piece of advice.  When you write out a piece of code, I find it relatively easy to just find little things that I want to change.  With JavaScript it&#8217;s usually something as simple as turning snippets that extend an object&#8217;s prototype into normal functions, as per <a href="http://www.nczonline.net/blog/2010/03/02/maintainable-javascript-dont-modify-objects-you-down-own/">best practice</a>.  With other languages, it might be something more complex, such as generalising a function designed for one case into a function designed for many cases.  You might dislike the specific formatting style that the example uses - change it.  Think you can use better variable names?  Use them.  Hell, if you&#8217;re just copying in an algorithm that you&#8217;re not entirely sure you grasp, try covering it in comments until you can see exactly what each line is there for.  (Admittedly, overuse of this particular example is probably a particularly bad idea, so if you find yourself doing this a lot, try finding less complex algorithms to do the same thing.  Alternatively, this might be the time you start looking for a well-maintained third-party library where someone else is doing all the&nbsp;legwork.)</p>
<p>Take for example, this beautiful JavaScript function that returns a repeated&nbsp;string:</p>
<div class="highlight"><pre><span class="c1">// This version will actually work thanks to</span>
<span class="c1">// http://www.reddit.com/r/javascript/comments/2pwz7l/the_definitive_guide_to_copying_and_pasting_in/cn0z7lm</span>
<span class="c1">// Modified from http://stackoverflow.com/questions/1235179/simple-way-to-repeat-a-string-in-java</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">times</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="k">this</span> <span class="o">+</span> <span class="k">this</span><span class="p">).</span><span class="nx">repeat</span><span class="p">(</span><span class="nx">times</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">return</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span> <span class="o">+</span> <span class="k">this</span><span class="p">).</span><span class="nx">repeat</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">times</span> <span class="o">/</span> <span class="mi">2</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>


<p>Some things I can easily do.  For example, this is using prototypes, and it isn&#8217;t even using them well.  It&#8217;s also using the fact that <code>if</code> can take a statement rather than a brace of statements.  Personally, I don&#8217;t like that, except for rare cases, and I&#8217;m not of the opinion that this is a rare enough case.  If I want to make it a stand-alone function, I&#8217;ll also need to change the name to make it clear that this is repeating a string.  Let&#8217;s see what it looks like&nbsp;now:</p>
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">repeatStr</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">times</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">repeatStr</span><span class="p">(</span><span class="nx">str</span> <span class="o">+</span> <span class="nx">str</span><span class="p">,</span> <span class="nx">times</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span> <span class="o">+</span> <span class="nx">repeatStr</span><span class="p">(</span><span class="k">this</span> <span class="o">+</span> <span class="k">this</span><span class="p">,</span> <span class="nx">times</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>To me, that looks a bit better.  But I&#8217;m still not sure what this function actually does.  I know it repeats strings, but what sort of magic is there under the hood?<sup id="fnref:obtuse"><a class="footnote-ref" href="#fn:obtuse" rel="footnote">2</a></sup>  This is the best time to start adding comments in.  Let&#8217;s smother that function.  We&#8217;ll also re-add the most important part of any copy-and-paste code: the attribution.  This is partly because your source clearly deserves the recognition, but mainly because - as with the rest of your code - you&#8217;ll probably come back later and wonder why you were so stupid as to write that.  At least when you can attribute parts of your code to others, it&#8217;s not your fault.  (We&#8217;ll discuss attribution slightly more properly a bit later&nbsp;on.)</p>
<div class="highlight"><pre><span class="c1">// Modified from http://stackoverflow.com/questions/1235179/simple-way-to-repeat-a-string-in-java</span>
<span class="kd">function</span> <span class="nx">repeatStr</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">times</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// if no times needed</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>     <span class="c1">// return empty string</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">times</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>                 <span class="c1">// if times is even</span>
        <span class="k">return</span> <span class="nx">repeatStr</span><span class="p">(</span><span class="nx">str</span> <span class="o">+</span> <span class="nx">str</span><span class="p">,</span> <span class="nx">times</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>  <span class="c1">// divide time by two, double str</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>                                                          <span class="c1">// if times is odd</span>
        <span class="k">return</span> <span class="k">this</span> <span class="o">+</span> <span class="nx">repeatStr</span><span class="p">(</span><span class="k">this</span> <span class="o">+</span> <span class="k">this</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">times</span> <span class="o">/</span> <span class="mi">2</span><span class="p">));</span>  <span class="c1">// divide time by two, double str, add str for remainder</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Do you begin to understand how it works a bit&nbsp;now?</p>
<h3>Always find an&nbsp;alternative.</h3>
<p>StackOverflow is a beautiful thing.  However, it is also a relatively fractured thing, and the sum of knowledge within it is built from many different parts, with opinions that can often appear to contradict each other.  This is the wonder of any system where opinions are crowd-sourced, and is why you should never trust the word of random blogs posted on link aggregation sites that claim to have all the answers.  There are always&nbsp;alternatives.</p>
<p>This is a good thing, because it means you&#8217;ve got to think for a bit.  Say you find a function on the internet that claims to repeat a string.  Say you find two, or three, or many functions.  At some point you&#8217;re going to need to decide between them.  And at that point you&#8217;re going to need to understand how they work, and more specifically, why they may or may not be appropriate to&nbsp;you.</p>
<p>The best example here is probably a for loop, not because it&#8217;s something that people regularly need to copy into their code, but because it&#8217;s something that&#8217;s so ubiquitous when it comes to optimization.  The standard mantra is that reverse for loops are the fastest loops, because back when programming required intimate knowledge of how a computer would spend each clock cycle, it was possible to implement a number of tricks in the computer hardware that could decrease the number of instructions used in each loop.  When you&#8217;re writing code that requires every last drop of performance from the <span class="caps">CPU</span>, and touching the bones of the computer to do so, each extra clock cycle can be a beautiful and valuable&nbsp;gift.</p>
<p>Of course, none of this applies to JavaScript.  Despite this, there are a plethora of ways of looping available to budding web developers, each claiming to be the best, the fastest, the most optimised, and each providing their own set of benchmarks to back this up.  The question then becomes how to choose between them - which in turn becomes a question of what you&#8217;re actually looking for in your for&nbsp;loops.</p>
<p>Of course, this will depend on what you need your for loop for.  Most of the time it will be fairly simple.  Perhaps you don&#8217;t need absolute blazing speed, but you do need the code to look clear and concise.  In that case, your solution might be a <code>for x in xs</code> loop, or perhaps <code>xs.forEach</code>.  Or perhaps you need backwards compatibility across all browsers currently in use, and all browsers not in use that your boss still demands compatibility for.  In that case, the humble <code>for (...) { }</code> loop is probably your best bet, and may god have mercy on your soul.  Maybe you&#8217;re developing an application that demands absolute blazing speed of a kind never before seen in an interpreted scripting language.  In that case, I have no idea what the perfect solution is, but it&#8217;s probably the sort of thing you&#8217;ll find out after a long time spent with a huge number of benchmarking&nbsp;suites.</p>
<p>This in turn has parallels for finding recipes on the internet.  You want to use the best tool for the job, and to do that you need to understand what jobs any snippets you find are.  In my experience the best way to do that is to find alternatives, and to compare and contrast.  You won&#8217;t be able to tell why snippet <em>a</em> is so good unless you know about its direct competitor <em>b</em>.  This way you&#8217;ll be able to expand your knowledge, and understand more easily what the text you&#8217;re copying into your code will actually&nbsp;do.</p>
<h2>Step 3:&nbsp;&#8230;Profit?</h2>
<p>Of course, all this advice is given with the aim of learning how to be a better programmer.  Over time, if you are repeatedly copying the same pieces of code into your project, that there&#8217;s probably a greater issue somewhere.  In some languages it might well be that you&#8217;re using the wrong idioms (creating a map where an enum-type would be more helpful, or complex case statements where a map would be more useful).  In other languages where the problem is more the lack of a standard library, the solution might be to find a third-party library that you can use consistently.  With JavaScript, the latter case is often true, and it may well be that learning how to effectively use tools such as <a href="https://lodash.com/">lodash</a> and <a href="http://underscorejs.org/">underscore</a> will help you a lot.  However, for those who are taking early steps in a language, I&#8217;d argue that copying and pasting is not wrong - as long as you do it&nbsp;properly.</p>
<h2>Step 4 and Step 0:&nbsp;Attributions!</h2>
<p><a href="http://www.reddit.com/user/jimschubert">/u/jimschubert</a> reminded me in the discussion on this post on Reddit that one important thing to do that I didn&#8217;t properly emphasise is to attribute your stuff properly (and even determine if you&#8217;re allowed to use it).  I did briefly mention when I talked about changing the code that it&#8217;s always good to put a comment saying where you got the code from, but proper attribution is an interesting legal issue.  For many things (particularly in web-development and Java applications), you&#8217;ll probably find your snippets from Stack Overflow.  Stack Overflow puts everything it hosts under the Creative Commons <a href="http://creativecommons.org/licenses/by-sa/3.0/"><span class="caps">CC</span> <span class="caps">BY</span>-<span class="caps">SA</span> 3.0</a> license.  Generally, this allows you to do with the content what you like, as long as you give &#8220;appropriate credit&#8221; (indicating if you changed it), and distribute any modifications under the same (or a compatible)&nbsp;license.</p>
<p>The other big source of snippets is blog posts and technical articles.  If the article is an &#8220;official source&#8221; (for example examples on the Mozilla <span class="caps">JS</span> docs), or a large enough software organisation they will probably have a note at the bottom of the page that gives you the official state of licensing for any information on that site.  (In the case of the <span class="caps">MDN</span> pages, code samples are either under the <span class="caps">MIT</span> license, or in public domain, while the rest of the text is under the <span class="caps">CC</span> <span class="caps">BY</span>-<span class="caps">SA</span> 2.5 license.)  For smaller blogs that haven&#8217;t thought about this issue, the issues are slightly more complex.  There are generally two schools of thought, one stating that if there&#8217;s no license, it&#8217;s in the public domain, and the other stating that in the absence of a license, it should be assumed that all rights are reserved.  It&#8217;s probably a good rule of thumb that someone releasing unlicensed code into the world does consider it public domain (this has always been my assumption, although having researched this little section, I realise it would probably be wise for me to think about licensing code snippets on my blog more carefully).  However, if you&#8217;re writing code on behalf of a company with concerns about being sued, the general feeling is usually that unlicensed code isn&#8217;t really worth&nbsp;it.</p>
<p>This, then would be my advice, partly built on trying to abide by the complicated legal issues, and partly built on just trying to be as nice as possible to the original&nbsp;authors:</p>
<ul>
<li>Always provide attributions and the source.  I don&#8217;t know of any license that forbids them, and it&#8217;s polite to do so.  Plus, as I said earlier, you can always blame other&nbsp;people.</li>
<li>Always say if you&#8217;ve modified the original.  (Of course, if you were following Step 2 properly, you&#8217;ll always be modifying it&nbsp;anyway!)</li>
<li>If you can see a license, obey any further stipulations in that license.  Note that some &#8220;viral&#8221; licenses may affect how you license your own work.  If you can&#8217;t abide by those licenses, you should not use the&nbsp;code.</li>
</ul>
<p>Again, I am not in any way, shape, or form a lawyer.  This is not legal advice.  But it&#8217;s my opinion, and probably some decent practical advice that might work for&nbsp;you.</p>
<h2>Side note about the&nbsp;title:</h2>
<p>It&#8217;s based on <a href="https://www.lucidchart.com/techblog/2014/12/02/definitive-guide-copying-pasting-javascript/">this</a> article submitted to the <a href="http://www.reddit.com/r/javascript"><code>/r/javascript</code></a> sub on Reddit.  That article is a very interesting one about how to use the clipboard from a JavaScript application in a cross-browser way, and is very interesting, but it did confuse me for a while as I did manage to get the wrong impression from the title.  For those people like me, who are easily confused by these simple matters, I submit this blog post, which might not&nbsp;help.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:pythonfailure">
<p>If I remember correctly, I got really irritated at that point, angrily turned the computer off, stormed off to my room, and didn&#8217;t come down for the rest of the day.  My poor father who&#8217;d been trying to please my yearning to become a programmer must&#8217;ve been really quite worried - thankfully that didn&#8217;t deter me significantly, and while I never got that code to work, I did continue learning Python.&#160;<a class="footnote-backref" href="#fnref:pythonfailure" rev="footnote" title="Jump back to footnote 1 in the text">[back]</a></p>
</li>
<li id="fn:obtuse">
<p>You might think this is me being obtuse.  This is a real snippet that I copied recently in Java.  I could see why it would be efficient (it doubles the length each time, rather than adding each string individually), but it took a while to connect in my head how exactly it worked, particular for cases that weren&#8217;t multiples of two.  By putting comments everywhere, I started to understand very clearly what each line was doing.&#160;<a class="footnote-backref" href="#fnref:obtuse" rev="footnote" title="Jump back to footnote 2 in the text">[back]</a></p>
</li>
</ol>
</div>
      </div>

        <hr class="article-divider">

    </article>
    <article class="blog-article">

      <header class="article-header">
        <h2 class="entry-title">
          <a href="https://mrjohz.github.io/posts/2014/Jul/16/i-made-a-thing-then-i-learned-some-more-things/" class="no-hilite" rel="bookmark" title="Permalink to I Made A Thing. Then I Learned Some MoreÂ Things.">
            I Made A Thing.  Then I Learned Some More&nbsp;Things.
          </a>
        </h2>
      </header>
      <footer class="article-footer">
        Published <abbr class="published" title="2014-07-16T10:35:18+01:00"> Wed 16 July 2014 </abbr>
          by <a href="https://mrjohz.github.io/author/johz.html">Johz</a>
      </footer>

      <div class="article-text">
        <p>I made a <a href="http://wfe.johz.me">thing</a>.  The thing is called &#8220;The <span class="caps">WFE</span> Thing&#8221;, because I am unoriginal with names.  It is a thing for WFEs, which are World Factbook Entries, which are a part of a not-particularly-famous game called <a href="http://www.nationstates.net/">NationStates</a>.  The importance of WFEs is hard to understand unless you understand raiding and defending in NationStates, and even then one could very easily fail to recognise the necessity of the tool I have constructed.  Essentially, sometimes bad people delete other people&#8217;s data, but this is entirely legal and acceptable in the game.  To counter this, other people come along afterwards and undo it, not because they have to as moderators or admins, but out of the fun of doing so, and out of care for the people whose data was deleted.  The <span class="caps">WFE</span> Thing records some (but not all) of this data from historical points so that it can be accessed easily at any time.  If this makes any sense to you at all, you&#8217;re a better person than&nbsp;me.</p>
<p>But enough about NationStates, let&#8217;s talk about The <span class="caps">WFE</span> Thing, because it was fun to make and I need an excuse to write a blog post because I&#8217;ve been really missing it&nbsp;recently.</p>
<p>The need for a historical list of WFEs (just think of this as a more regular, specific version of the <a href="http://archive.org/web/">Wayback Machine</a>) has produced multiple versions of The <span class="caps">WFE</span> Thing.  The original was created by a lovely chap named Solm, in <span class="caps">PHP</span>, and it generally worked really well, until at some point it stopped working.  At that point, I decided that I could make my own one.  This was around the time that I had been making this blog, and what I really like about this blog is that it is entirely static, and yet the Javascript on it gives it a lovely dynamic feel.  So I wondered if I could make a <span class="caps">WFE</span> thing that was entirely static except for a javascript-based&nbsp;frontend.</p>
<p>The basic idea was that if pages could be static files, so could too could the <span class="caps">API</span> a set of static .json files in an <code>api/</code> directory somewhere.  There&#8217;s a lot of merit to this idea in many respects.  If you use traditional server software such as <a href="http://www.apache.org/">Apache</a> or <a href="http://wiki.nginx.org/Main">Nginx</a>, you&#8217;ve already got a system that is extremely optimised for throwing files down the right tubes to make a website.  Things go quickly, but they also go efficiently, which, when you have a site with a lot of load, means things break a lot less.  Now I didn&#8217;t expect to recieve a lot of load, but the idea of high speeds without much work appealed to my naive sensibilities, and so the second <span class="caps">WFE</span> thing was&nbsp;convieved.</p>
<p>There are, however, a lot of reasons why one would use a database over keeping data in the filesystem.  The first of these is that a database usually has a very sensible and clever query language or <span class="caps">API</span> to go with it.  For example, when I obtain a new piece of data, I want to attach it to the correct file.  Because in my case the data doesn&#8217;t change very often, I also don&#8217;t want to repeat myself.  Specifically, if the new data is the same as the older piece of data, I want to save a &#8220;null row&#8221; into the system that identifies that this row is a duplicate of a previous row.  As a result, to decide if I want to save this particular piece of data, I can execute the following&nbsp;query:</p>
<div class="highlight"><pre><span class="k">SELECT</span> <span class="n">myfield</span> <span class="k">FROM</span> <span class="n">mytable</span> <span class="k">WHERE</span>
    <span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;&lt;dataname&gt;&#39;</span> <span class="k">AND</span>
    <span class="nb">date</span> <span class="o">&lt;</span> <span class="s1">&#39;&lt;inputdate&gt;&#39;</span> <span class="k">AND</span>
    <span class="n">myfield</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">date</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">1</span>
</pre></div>


<p>Here, I specify the name, and (because I don&#8217;t necessarily insert data in chronological order) that the in-table data must come from before a particular date.  I also specify that the <code>myfield</code> field isn&#8217;t null, because if it is null then I know that this was a duplicate of a previous row, so I&#8217;d need to continue searching anyway.  I can also add <code>LIMIT 1</code>, which ensures that the database query stops as soon as it&#8217;s found the relevant data.  Then I can test the value of <code>myfield</code> against the data that I have just obtained, to decide if I need to add a new one.  It&#8217;s simple, pretty quick (because almost all the logic is being performed by the highly-optimised database), and it works every&nbsp;time.</p>
<p>On the other hand, in a filesystem database with .json files, I need to put a lot more logic into my application to deal with this kind of query.  Here&#8217;s a basic implementation in Python that attempts to do roughly the same&nbsp;thing.</p>
<div class="highlight"><pre><span class="n">items</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;&lt;dataname&gt;&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;date&#39;</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s">&#39;&lt;inputdate&gt;&#39;</span><span class="p">:</span>
        <span class="k">continue</span> <span class="c"># We&#39;re only looking at rows before inputdate</span>

    <span class="k">if</span> <span class="n">datavalue</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">continue</span> <span class="c"># We don&#39;t want null values</span>

    <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;myfield&#39;</span><span class="p">]</span> <span class="c"># Assuming this is tucked into a function somehow</span>
</pre></div>


<p>This isn&#8217;t very simple, and it does a lot of unnecessary work.  For a start, I need to access the entire file, even the parts of it that I have no interest in using.  For small files, this isn&#8217;t much of an issue, but it&#8217;s slow.  For larger files, there&#8217;s a good chance that I&#8217;m looking at a tiny fraction of the actual file, which is just wasteful.  Thankfully Python&#8217;s sort functions are apparently very efficient, and the <code>key</code> argument makes sorting by a particular field very easy.  However, I can&#8217;t add conditions into my sort or selection here, so once the files have been sorted I&#8217;ll also need to filter out rows that don&#8217;t match my date criteria, (and at Python-speeds rather than the optimised <span class="caps">SQL</span>-speeds).  It&#8217;s only then that I can actually return the small piece of data that I was looking&nbsp;for.</p>
<p>There are other problems with this, not least the fact that this particular piece of code relies on the <span class="caps">JSON</span> file being an array, rather than an object, which is actually a security risk in certain cases.  But the worst crime of all is that this snippet is so much longer than the other one to do exactly the same thing but slower.  Now of course this logic has been put into a function (hence the <code>return</code> at the end), but if I&#8217;m writing worse code to do a worse job, something&#8217;s going&nbsp;wrong.</p>
<p>That&#8217;s not the only difference between a file-system and a database.  For a start, if I&#8217;m using <span class="caps">JSON</span>, I need to store the name of each field, and I need to store it in every single file on the system.  On the other hand, in a traditional <span class="caps">SQL</span> database I store the name of each field once (we&#8217;ll ignore special cases like MongoDB and other NoSQL systems for now), and each row just needs a basic separator.  I could shorten the names of the json fields, or even convert each row to an array, but then I&#8217;d need an encoding and decoding library on both sides of the app.  I also haven&#8217;t begun to talk about locking and synchronisation issues.  In this case it probably isn&#8217;t so bad, as there is only ever one person putting new data into the system at a time (that&#8217;s me!).  As far as I can tell, the worst possible case is that in certain circumstances a user might get outdated data, which isn&#8217;t a desperately troublesome issue for The <span class="caps">WFE</span> Thing.  Of course, in the general case, this may not be true at all, and if I&#8217;d gone much further, I&#8217;d probably end up missing the ACIDity of most <span class="caps">SQL</span>&nbsp;databases.</p>
<p>Despite all this, I do feel the need to point out that I can still see the case for a static <span class="caps">API</span> in very specific circumstances.  It&#8217;s definitely more work, but it may be worth it.  There are a lot of optimisations that a clever load script could make, including ensuring the data is always pre-sorted rather than sorting it on the fly.  Indeed, I&#8217;ve assumed that I should try to minimise the filesize in both cases, but if I knew I had the space, I could very easily save <code>myfield</code> every single time, even if it was repeated data.  This is actually what I server to users, so that&#8217;s another optimisation to&nbsp;make.</p>
<p>Why, then, did I use a <a href="http://www.sqlite.org/">SQLite</a> database as my primary storage mechanism in the end?  Because I was performing premature optimisations.  You can read more about why premature optimisations are the root of all evil by searching &#8220;premature optimisation is the root of all evil&#8221; anywhere.  Even Bing would be able to return some good advice.  However, you probably won&#8217;t recognise the truth of the problem until you&#8217;ve prematurely optimised yourself.  With that in mind, allow me to elucidate the situation where a static <span class="caps">API</span> might be&nbsp;useful.</p>
<p>The site needs to have a lot of visitors.  A hell of a lot of visitors.  Facebook-level visitors.  Enough visitors that even on the most secure and stable of servers (hell, even using NodeJS&#8217; webscaleity) you&#8217;re starting to be a bit worried.  You should also have a genuine worry about such things as DDoS attacks.  Your site also sends a lot of hits (hundreds, thousands) to the backend <span class="caps">API</span> with each request to the mainpage.  There&#8217;s probably a lot of very rapid and heavy polling involved.  Your site is probably designed badly, but for some unknown reason you are unable to change that part of it.  Additionally (and this one is very important) only the backend triggers changes, and those changes occur infrequently.  We&#8217;re also not talking about Big Data - there&#8217;s not enough data that you&#8217;re using several servers and need to worry about routing, and you also probably don&#8217;t need to sort it in complex ways to understand the patterns within the&nbsp;data.</p>
<p>If you do find yourself in this situation&#8230;  Get out of there as fast as you can.  Or you could try a static <span class="caps">API</span>.  If that <em>specific</em> set of circumstances were to come&nbsp;about.</p>
<p>I would like to finish with a quick story that I hope suggests that I&#8217;ve learned my lesson about premature optimisations, and might be of some interest to Python programmers.  The backend is now written in the beautiful (if somewhat overshadowed) <a href="http://bottlepy.org/docs/dev/index.html#">Bottle</a> microframework, which was great fun, especially as I got to use Python 3.4 (the best Python!).  Bottle makes deployment relatively easy, at is already has basic configurations for a number of Python <span class="caps">WSGI</span> servers.  (Think of Bottle as your <span class="caps">PHP</span> scripts, and the <span class="caps">WSGI</span> servers as your Apache setup - it&#8217;s basically like that but completely different.)  Originally I was going to use the standard mod_wsgi setup on my webfaction server, but trying to set that up with the structure I currently had wasn&#8217;t going very well, so I quickly Googled what the fastest <span class="caps">WSGI</span> server was.  (The answer, it turns out, is probably <a href="https://github.com/jonashaag/bjoern">Bjoern</a>.)  However, while looking for this, I found a few reports that suggested <a href="http://meinheld.org/">Meinheld</a> was quite good for combining speed with stability.  So, remembering my lesson about premature optimisation, I tested everything, quite thoroughly, against some of the slower servers.  Every server came out exactly the&nbsp;same.</p>
<p>The reason is quite obvious: I didn&#8217;t need any async fanciness, because I wasn&#8217;t going to get enough requests to merit anything so complex.  The users of this app will almost all access it between 6:00am - 1:00pm, 6:00pm - 1:am <span class="caps">GMT</span>.  There will be about five unique users in total, making perhaps 30-40 requests over that seven hour period on the rare busy day.  That&#8217;s pretty much the entire usage I&#8217;m expecting.  I don&#8217;t need to optimise the speed of my server.  What I should, however, be optimising is how quickly I can make this site instead of leaving the users to struggle with my old broken attempts.  Additionally, I need to remember to optimise the usefulness of the <span class="caps">UI</span>.  Speed, for me, doesn&#8217;t come into this, which means I have time to optimise the things that I forgot about last time in my quest for the fastest response.  Today I finally learned that premature optimisation is the root of all evil.  And more importantly, it makes things <em>hard</em>.</p>
      </div>

        <hr class="article-divider">

    </article>
    <article class="blog-article">

      <header class="article-header">
        <h2 class="entry-title">
          <a href="https://mrjohz.github.io/posts/2013/Nov/11/building-a-pure-javascript-theme-switcher/" class="no-hilite" rel="bookmark" title="Permalink to Building a Pure-Javascript ThemeÂ Switcher">
            Building a Pure-Javascript Theme&nbsp;Switcher
          </a>
        </h2>
      </header>
      <footer class="article-footer">
        Published <abbr class="published" title="2013-11-11T18:16:29+00:00"> Mon 11 November 2013 </abbr>
          by <a href="https://mrjohz.github.io/author/johz.html">Johz</a>
      </footer>

      <div class="article-text">
        <p>You might have noticed that you can change the theme of my blog.  I&#8217;m quite sure I&#8217;ve told you before that you can do this, but I&#8217;m going to tell you again, because I&#8217;m really proud of working out how to add this functionality, especially making it either work or fail gracefully on pretty much all browsers, and making it persist across sessions.  The exciting part for me is that this is entirely client-side, so it works on a static blog or website, which mine is.  I recognise that it&#8217;s simple, easy, and my pride is entirely unwarranted, but dammit it makes me feel&nbsp;good.</p>
<p>I&#8217;ve spent today rewriting the code that does this to make it prettier, and more reusable.  For example, if you click on <a href="javascript:void(0)" onclick="themeSwitcher.setStyle(-1);">this link</a>, the entire theme will change to a different one.  It&#8217;s also much easier to add new themes now, as there&#8217;s only one place that they&#8217;re&nbsp;specified.</p>
<p>So how does this all work?  Well, assuming you&#8217;ve already got a document and a couple of stylesheets that you want to switch between, we&#8217;ll start by defining a themeSwitcher&nbsp;object.</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">themes</span> <span class="o">=</span> <span class="nx">themes</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">;</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>Here, we&#8217;re simply creating a single object with an anonymous constructor function.  The constructor takes two arguments, the list of themes, and the default theme.  We store the list of themes directly, but instead of storing the defaultTheme as is (in a string format) we store it internally as an index.  We also need to set the currentTheme, which of course is the default theme by&nbsp;default.</p>
<p>Next we need to find out if there are any stylesheets already saved.  For this we need some sort of peristent storage.  I used localStorage, but there are other storage alternatives out there.  The other big contender that you might think about using is cookie storage.  There are three big differences between the two of these, for our uses at&nbsp;least.</p>
<p>Firstly, cookies are a pain to handle, whereas working with localStorage is a dream.  For me, this was the biggest reason for turning to localStorage.  Secondly, localStorage isn&#8217;t entirely cross-browser.  While localStorage is available for about <a href="http://caniuse.com/#feat=namevalue-storage" title="Can I Use: name-value Storage">90%</a> of your users, if you think you&#8217;re going to get a lot of traffic from older browsers that might be a consideration for you.  Thirdly, cookies are sent to the server.  This particular theme switcher is entirely client-side, so that&#8217;s not necessary, but if you wanted to add some sort of server-side code that deals with the theme, you might want to think about using&nbsp;cookies.</p>
<p>However, for me localStorage seemed to be the best answer.  Of course, if we&#8217;re using localStorage, we&#8217;re going to need to ensure that localStorage exists.  If you&#8217;ve already got <a href="http://modernizr.com/" title="Modernizr - Feature detection">Modernizr</a> installed, you should use that.  However, I didn&#8217;t, and I didn&#8217;t want to include a whole new library just to find out if I could use one feature, so I <a href="https://github.com/Modernizr/Modernizr/blob/master/feature-detects/storage/localstorage.js" title="The localStorage test in Modernizr's source">used the source</a>, and borrowed the test that Modernizr used.  This is what it looks&nbsp;like:</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="c1">// Assume that localStorage doesn&#39;t</span>
                         <span class="c1">// work until proven otherwise</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">themes</span> <span class="o">=</span> <span class="nx">themes</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// Do a test</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">);</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Test failed</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>Beautiful.</p>
<p>Now if localStorage exists, that still doesn&#8217;t mean that there&#8217;s anything saved there.  The stuff that&#8217;s saved there could also be complete gobbledygook.  If you can, have a look at what localStorage saves on this site.  (On Chrome, press Ctrl-Shift-i, go to &#8220;Resources&#8221;, and &#8220;Local Storage&#8221;.)  Edit it to something that isn&#8217;t &#8220;dark&#8221; or &#8220;lite&#8221;, reload the page, and you&#8217;ll see that the site automatically uses the &#8220;dark&#8221; theme.  That&#8217;s because the alternative would be to load no stylesheet at all, and I really don&#8217;t want that to&nbsp;happen.</p>
<p>To check if the value saved is an acceptable value, the easiest thing we can do is find out if it&#8217;s in the array of themes that was passed into the constructor.  The best way to do this is <code>Array.prototype.indexOf</code>, which works on most browsers, but not all.  Unfortunately, there are browsers that implement localStorage and not indexOf, so we need to write our own indexOf function for those cases.  I based mine on the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Compatibility" title="Array.prototype - Mozilla docs">Mozilla sample implementation</a>, minified it because it was useless and ugly, and added it to the top of the script.  Note that this implementation doesn&#8217;t modify the Array&nbsp;prototype.</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">indexOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">t</span><span class="p">,</span><span class="nx">n</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">){</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
    <span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">))}</span><span class="kd">var</span> <span class="nx">r</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">n</span><span class="o">?</span><span class="nx">n</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">s</span><span class="p">;</span><span class="nx">s</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">===</span><span class="mi">0</span><span class="o">||</span><span class="nx">i</span><span class="o">&gt;=</span><span class="nx">s</span><span class="p">){</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">i</span><span class="o">=</span><span class="nx">s</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">i</span><span class="p">)}</span><span class="k">for</span><span class="p">(</span><span class="nx">r</span><span class="o">=</span><span class="nx">i</span><span class="p">;</span><span class="nx">r</span><span class="o">&lt;</span><span class="nx">s</span><span class="p">;</span><span class="nx">r</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span><span class="o">==</span><span class="nx">t</span><span class="p">){</span><span class="k">return</span> <span class="nx">r</span><span class="p">}}</span>
    <span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">themes</span> <span class="o">=</span> <span class="nx">themes</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">);</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="c1">// Get the theme stylesheet, and check that it exists</span>
    <span class="nx">stylesheet</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;theme-stylesheet&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">stylesheet</span><span class="p">);</span> <span class="c1">// Note shim!</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>So now themeSwitcher is an object that contains a list of all possible themes, the current theme, the default theme, and a flag that tells us if localStorage exists or not.  That&#8217;s all very useful, but none of it actually changes the theme.  Indeed, we haven&#8217;t even installed a theme on the page.  This theme switching system still requires a bit of&nbsp;work.</p>
<p>Firstly, let&#8217;s add a function that writes the current theme to the document.  There are multiple ways of doing this, and some are more idiomatic and beautiful than others, but since all we&#8217;re actually doing is writing a single line of <span class="caps">HTML</span>, I&#8217;ve opted for <code>document.write</code>.  Sure, you should probably build an element, and append it somewhere to the <span class="caps">DOM</span>, but I&#8217;m lazy, and that feels like way too many lines of&nbsp;code.</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/*</span>
<span class="cm">  indexOf function</span>
<span class="cm">    ...</span>
<span class="cm">  constructor statements &amp; test for localStorage</span>
<span class="cm">  */</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">writeStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// remember that currentTheme is an index, not a theme name</span>
    <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">];</span>
    <span class="c1">// Modify the html here as you please.</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;link id=&quot;main-theme&quot; href=&quot;/static/css/&#39;</span><span class="p">);</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">styleName</span> <span class="o">+</span> <span class="s1">&#39;.css&quot; rel=&quot;stylesheet&quot; /&gt;&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>I&#8217;m creating a function to do this, because that&#8217;s the way that feels most idiomatic to me.  (This is probably ironic, considering the previous paragraph.)  You could just do the <code>document.write</code> as a statement within the constructor, but this means that later you&#8217;ll have less control over when and where you place the&nbsp;link.</p>
<p>The other thing that we need is a way to change the themes once the document is loaded.  After all, expecting the user to reload the page every time they change the theme is a bit much to ask, don&#8217;t you think?  The way I chose to do this was by writing two private <code>_setStyle</code> function, and then defining one of them based on whether localStorage existed.  You could use an if-statement, and test on the <code>lsExists</code> attribute, but why bother when the try/catch statement already divides flow into two sections for you to&nbsp;use?</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/*</span>
<span class="cm">  indexOf function</span>
<span class="cm">    ...</span>
<span class="cm">  constructor statements</span>
<span class="cm">  */</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="cm">/* get theme stylesheet */</span>

    <span class="c1">// _setStyle if localStorage exists</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_setStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// check that the theme really does exist</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">];</span>
        <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="c1">// Get the URL of the link, and change it to the URL</span>
      <span class="c1">// of the new link.  This assumes that all the css</span>
      <span class="c1">// sheets are sitting in the same directory.  It also</span>
      <span class="c1">// assumes that only one css sheet is needed to define</span>
      <span class="c1">// a theme.  You can modify this if that isn&#39;t the case.</span>
      <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;main-theme&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">splits</span> <span class="o">=</span> <span class="nx">link</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">splits</span><span class="p">[</span><span class="nx">splits</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">styleName</span> <span class="o">+</span> <span class="s1">&#39;.css&#39;</span><span class="p">;</span>
      <span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">splits</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>

      <span class="c1">// Make sure we save the new theme name so that</span>
      <span class="c1">// the choice persists across sessions.</span>
      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;pillbox-theme&#39;</span><span class="p">,</span> <span class="nx">styleName</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="c1">// _setStyle if localStorage does not exists</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_setStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// the style will always be the current theme,</span>
      <span class="c1">// which will always be the default theme.</span>
      <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">];</span>

      <span class="c1">// Still write the new theme into the document,</span>
      <span class="c1">// just in case something has gone horribly wrong.</span>
      <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;main-theme&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">splits</span> <span class="o">=</span> <span class="nx">link</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">splits</span><span class="p">[</span><span class="nx">splits</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">styleName</span> <span class="o">+</span> <span class="s1">&#39;.css&#39;</span><span class="p">;</span>
      <span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">splits</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>


  <span class="cm">/* writeStyle function */</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>You can now start playing with things in your browser.  Assuming you&#8217;ve got all your stylesheets in the right place, and a basic <span class="caps">HTML</span> layout, insert this code at the top of the <code>&lt;head&gt;</code> brackets.  Then open up a development console and start calling <code>themeSwitcher._setStyle</code> with various values.  Notice that you can only use indices to specify which theme you want.  Let&#8217;s change that.  When we make our public setStyle function, we want to also be able to specify the string name of the css file.  I also want there to be a way to call it without specifying the theme, and let it toggle between&nbsp;themes.</p>
<p>To do this, we&#8217;re going to need an algorithm that can take a string, integer, or null input, and return the index of the theme that best matches the description.  Now that sounds like a fairly useful algorithm to use, so in the interests of <span class="caps">DRY</span>, let&#8217;s implement it as a new function, <code>themeSwitcher.getStyle</code>, then add <code>themeSwitcher.setStyle</code> on top of&nbsp;it.</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/*</span>
<span class="cm">  indexOf function</span>
<span class="cm">    ...</span>
<span class="cm">  constructor statements</span>
<span class="cm">  */</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="cm">/* localStorage exists _setStyle implementation */</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* localStorage doesn&#39;t exist _setStyle implementation */</span>
  <span class="p">}</span>

  <span class="cm">/* writeStyle function */</span>

  <span class="c1">// public getStyle method</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Firstly, check if stylesheet is undefined or null.</span>
    <span class="c1">// In this case we&#39;ll return the current theme.</span>
    <span class="c1">// This allows us to use themeSwitcher.themes[themeSwitcher.getStyle()]</span>
    <span class="c1">// to find out the current theme.</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">stylesheet</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">stylesheet</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Next, stylesheet could be an index.  Return either the index,</span>
    <span class="c1">// or if index is invalid, the current theme.</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">stylesheet</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span>
               <span class="o">&amp;&amp;</span>   <span class="nx">stylesheet</span> <span class="o">===</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">stylesheet</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">stylesheet</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">stylesheet</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Otherwise, assume stylesheet is the name of a style.</span>
    <span class="c1">// If it isn&#39;t, then it won&#39;t be in the list of themes,</span>
    <span class="c1">// so just return the current theme.</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">stylesheet</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">index</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// public setStyle method</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// get the style index using getStyle</span>
    <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">);</span>

    <span class="c1">// if the stylesheet is the same as the current</span>
    <span class="c1">// stylesheet, toggle the stylesheet to the next one</span>
    <span class="c1">// in the list of themes.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">index</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Use whichever private _setStyle function was defined</span>
    <span class="c1">// to set the style of the page.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_setStyle</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>The main theme switching mechanism is now pretty much almost done.  Unfortunately, unless the user plays around with their development console, they&#8217;re not going to be able to change much.  This is where we need to add an element on the page that actually allows the user interface to work.  I&#8217;ve implemented this here in the form of a <code>select</code> drop-down choice form element, but of course you can edit and play with this code as much as you&nbsp;want.</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/* initialisation, writeStyle, getStyle and setStyle definitions */</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">addSwitcher</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elementID</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Append our switcher to #elementID</span>
    <span class="nx">elem</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">elementID</span><span class="p">);</span>

    <span class="c1">// We&#39;re using a select element</span>
    <span class="nx">switcher</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">);</span>
    <span class="nx">switcher</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;theme-switcher-select&quot;</span><span class="p">;</span>

    <span class="c1">// Iterate through the themes, and append them as options</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">theme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">option</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
      <span class="nx">option</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">theme</span>
      <span class="nx">option</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">theme</span><span class="p">))</span>

      <span class="c1">// The current theme should be selected</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">option</span><span class="p">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">switcher</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">option</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="c1">// When a new option is selected, call our setStyle function</span>
    <span class="nx">switcher</span><span class="p">.</span><span class="nx">onchange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">var</span> <span class="nx">theme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">theme</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Append to the document</span>
    <span class="nx">elem</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">switcher</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">)</span>
</pre></div>


<p>And voila, a complete client-side theme switching solution.  How do you use this?  Well, the above definition should go in your <code>&lt;head&gt;</code> section in a <code>&lt;script&gt;</code> tag.  Then, immediately afterwards, you should call <code>themeSwitcher.writeStyle()</code>.  Now the rest of your page can load, with the correct stylesheet enabled.  In the place where you want the theme-switching interface, create a container element with an id, then immediately below that, in script tags, call <code>themeSwitcher.addSwitcher(elementID)</code>, where elementID is of course the id of the container element.  Check out the source code of this page to see it in action.  I&#8217;ve minified the function definition, but it works exactly the&nbsp;same.</p>
<p>Here&#8217;s the complete&nbsp;listing.</p>
<div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">themeSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">indexOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">t</span><span class="p">,</span><span class="nx">n</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">){</span><span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">1</span><span class="p">))}</span><span class="kd">var</span> <span class="nx">r</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">n</span><span class="o">?</span><span class="nx">n</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">s</span><span class="p">;</span><span class="nx">s</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">===</span><span class="mi">0</span><span class="o">||</span><span class="nx">i</span><span class="o">&gt;=</span><span class="nx">s</span><span class="p">){</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">i</span><span class="o">=</span><span class="nx">s</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">i</span><span class="p">)}</span><span class="k">for</span><span class="p">(</span><span class="nx">r</span><span class="o">=</span><span class="nx">i</span><span class="p">;</span><span class="nx">r</span><span class="o">&lt;</span><span class="nx">s</span><span class="p">;</span><span class="nx">r</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span><span class="o">==</span><span class="nx">t</span><span class="p">){</span><span class="k">return</span> <span class="nx">r</span><span class="p">}}</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">themes</span> <span class="o">=</span> <span class="nx">themes</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">defaultTheme</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">);</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="nx">stylesheet</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;theme-stylesheet&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">stylesheet</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">_setStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">];</span>
        <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;main-theme&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">splits</span> <span class="o">=</span> <span class="nx">link</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">splits</span><span class="p">[</span><span class="nx">splits</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">styleName</span> <span class="o">+</span> <span class="s1">&#39;.css&#39;</span><span class="p">;</span>
      <span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">splits</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>

      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;pillbox-theme&#39;</span><span class="p">,</span> <span class="nx">styleName</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lsExists</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">_setStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">];</span>
      <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;main-theme&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">splits</span> <span class="o">=</span> <span class="nx">link</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">splits</span><span class="p">[</span><span class="nx">splits</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">styleName</span> <span class="o">+</span> <span class="s1">&#39;.css&#39;</span><span class="p">;</span>
      <span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">splits</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">writeStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">styleName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">];</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;link id=&quot;main-theme&quot; href=&quot;/static/css&#39;</span><span class="p">);</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">styleName</span> <span class="o">+</span> <span class="s1">&#39;.css&quot; rel=&quot;stylesheet&quot; /&gt;&#39;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">stylesheet</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">stylesheet</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">stylesheet</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span>
                 <span class="o">&amp;&amp;</span>   <span class="nx">stylesheet</span> <span class="o">===</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">stylesheet</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">stylesheet</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">stylesheet</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">indexOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">,</span> <span class="nx">stylesheet</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">index</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="nx">stylesheet</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">index</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_setStyle</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">addSwitcher</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elementID</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">elem</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">elementID</span><span class="p">);</span>
    <span class="nx">switcher</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">);</span>
    <span class="nx">switcher</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;theme-switcher-select&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">theme</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">themes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">option</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
      <span class="nx">option</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">theme</span>
      <span class="nx">option</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">theme</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTheme</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">option</span><span class="p">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">switcher</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">option</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">switcher</span><span class="p">.</span><span class="nx">onchange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
      <span class="nx">themeSwitcher</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">elem</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">switcher</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">})([</span><span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">,</span> <span class="s1">&#39;stylesheet2.css&#39;</span><span class="p">],</span> <span class="s1">&#39;stylesheet1.css&#39;</span><span class="p">);</span>
</pre></div>
      </div>


    </article>

    <p class="paginator">
            &laquo;
        Page 1 / 2
            <a href="https://mrjohz.github.io/tag/coding2.html">&raquo;</a>
    </p>
</section>


      <div id="theme-switcher">
        Change Theme <br />
      </div>
      <script>
        themeSwitcher.addSwitcher('theme-switcher');
        themeSwitcher.addCycleButtons();
      </script>

    <footer id="footer">
      <p>This blog is built using <a href="http://getpelican.com">Pelican</a>, <a href="http://python.org">Python</a>, and the Pillbox theme.</p>
      <p>
<a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/" class="no-hilite">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0" />
</a>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/" class="no-hilite">
    <img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
</a><br />
Unless otherwise specified, content on this blog is available under the
<a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons
Attribution 4.0 International License</a>.  Likewise, unless otherwise
specified, code samples are in the
<a href="http://creativecommons.org/publicdomain/zero/1.0/">public domain</a>.
The blog's theme (pillbox) is available under the MIT license on
<a href="https://github.com/MrJohz/pillbox-theme">Github</a>.
</p>
    </footer>



  </body>

</html>