<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Johz</title><link href="https://mrjohz.github.io/" rel="alternate"></link><link href="https://mrjohz.github.io/feeds/jonathan-frere.atom.xml" rel="self"></link><id>https://mrjohz.github.io/</id><updated>2015-04-15T11:50:00+01:00</updated><entry><title>Writing Python in Python</title><link href="https://mrjohz.github.io/posts/2015/Apr/15/python-in-python/" rel="alternate"></link><updated>2015-04-15T11:50:00+01:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2015-04-15:posts/2015/Apr/15/python-in-python/</id><summary type="html">&lt;p&gt;Python was my first programming language.  Some time around the age of sixteen or
seventeen, I got it into my head that I should learn a programming language, and one thing
lead to another, and I ended up working through Swaroop&amp;#8217;s &lt;a href="http://www.swaroopch.com/notes/python/"&gt;A Byte of Python&lt;/a&gt;, and
then Sande &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Sande&amp;#8217;s &lt;a href="http://www.manning.com/sande/"&gt;Hello World&lt;/a&gt;.  The latter was particularly good,
and I learned a lot of stuff, and, alongside most new programmers, I loved getting my
computer to do things that I&amp;#8217;d told it to&amp;nbsp;do.&lt;/p&gt;
&lt;p&gt;That said, Python didn&amp;#8217;t excite me.  Programming was cool, and new, and fun, but Python
itself was, well, the tool I used.  And a fairly standard tool at that.  What changed
was &lt;a href="http://corepython.com/"&gt;Core Python Programming&lt;/a&gt;.  (Yes, this is basically book review corner,
I&amp;#8217;ll get to the more interesting stuff in a minute&amp;#8230;)  Core Python, despite being
somewhat out-of-date at this point (although it does include notes on pre-announced 2.6
features, and a couple of paragraphs on how Python will slowly be transitioning to
&amp;#8220;Python 3000&amp;#8221;, which I&amp;#8217;m sure if very exciting news for all of us!) was a particularly
good book at describing Python, rather than just programming.  Which finally brings us
on to the first bit of code that made me feel really excited about &lt;em&gt;Python&lt;/em&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;my_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__add__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;my_num&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;other&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;my_num&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__repr__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;MyNumber(&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;my_num&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;)&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;What&amp;#8217;s so special about these two lines?  Well, this is a method inside a user-defined
class in Python.  More specifically, it&amp;#8217;s a &amp;#8220;magic method&amp;#8221;, or dunder method (dunder as
in double underscore) that is called when the addition operator is used on the defined
class.  It allows the user of this class to write code that looks like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;  &lt;span class="c"&gt;# MAGIC!&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;my_num&lt;/span&gt;
&lt;span class="go"&gt;15&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To me, however, this was my first chance to break open Python and write&amp;nbsp;inside.&lt;/p&gt;
&lt;p&gt;You see, Python is written in Python.  This is an almost entirely untrue statement, so I
probably ought to explain myself first.  I&amp;#8217;m not talking about the interpreter, which for
most people is written in C.  No, I&amp;#8217;m talking about the language itself.  The language
&amp;#8220;Python&amp;#8221; is written in&amp;nbsp;Python.&lt;/p&gt;
&lt;p&gt;This statement is only somewhat untrue.  That&amp;#8217;s a start!  Here&amp;#8217;s an&amp;nbsp;example.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__add__&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;method-wrapper &amp;#39;__add__&amp;#39; of int object at 0x829c1c0&amp;gt;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__add__&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;bound method MyNumber.__add__ of MyNumber(3)&amp;gt;&lt;/span&gt;

&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__add__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;10&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;
&lt;span class="go"&gt;10&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__add__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;MyNumber(10)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;MyNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;MyNumber(10)&lt;/span&gt;

&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;  &lt;span class="c"&gt;# Python doesn&amp;#39;t do automatic coercion, remember!&lt;/span&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;1&lt;/span&gt;, in &lt;span class="n"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="gr"&gt;TypeError&lt;/span&gt;: &lt;span class="n"&gt;unsupported operand type(s) for +: &amp;#39;int&amp;#39; and &amp;#39;str&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__add__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c"&gt;# Surely this should do the same thing?&lt;/span&gt;
&lt;span class="go"&gt;NotImplemented&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;1&lt;/span&gt;, in &lt;span class="n"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;5&lt;/span&gt;, in &lt;span class="n"&gt;__add__&lt;/span&gt;
&lt;span class="gr"&gt;AttributeError&lt;/span&gt;: &lt;span class="n"&gt;&amp;#39;str&amp;#39; object has no attribute &amp;#39;my_num&amp;#39;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__add__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;1&lt;/span&gt;, in &lt;span class="n"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
  File &lt;span class="nb"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;, line &lt;span class="m"&gt;5&lt;/span&gt;, in &lt;span class="n"&gt;__add__&lt;/span&gt;
&lt;span class="gr"&gt;AttributeError&lt;/span&gt;: &lt;span class="n"&gt;&amp;#39;str&amp;#39; object has no attribute &amp;#39;my_num&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The most interesting bits here are the differences between the built-in int operations,
and the custom MyNumber class operations.  Here&amp;#8217;s each one in&amp;nbsp;turn:&lt;/p&gt;
&lt;p&gt;Firstly, in Python 3, classes have functions attached to them.&amp;nbsp;Instances&lt;/p&gt;</summary><category term="python"></category><category term="coding"></category></entry><entry><title>A Collection of Benchmarks that I Found Useful</title><link href="https://mrjohz.github.io/posts/2015/Jan/17/get-benched/" rel="alternate"></link><updated>2015-01-17T12:02:32+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2015-01-17:posts/2015/Jan/17/get-benched/</id><summary type="html">&lt;p&gt;As Donald Knuth once explained, 97% of a programmer&amp;#8217;s time should be spent making their code as fast as possible.  (The other 3% is waiting for the code to compile.)  Most programmers have a host of shortcuts, tricks, and clever codes up their sleeves to ensure that their code runs as fast as it possibly can.  For example, in JavaScript, many developers have spent years studying the secret arts of the for-loop to determine how to loop through arbitrary numbers most quickly.  (The answer to this particular question is actually an inverse-backwards while-never-done-loop, where the first character on each line is an &amp;#8216;a&amp;#8217;, and where the programmer chants hymns worshipping Azathoth.)  The faster their code works, the more web-scale their &lt;del&gt;node.js&lt;/del&gt; io.js programs will&amp;nbsp;be.&lt;/p&gt;
&lt;p&gt;There are lots of myths, legends, and rumours about optimization, and it&amp;#8217;s often very difficult to sort out the truth from the lies.  However, to help us in our quest for absolute speed, good programmers should always use benchmarks.  Benchmarks are a way of comparing like-for-like speeds of two programs, each containing different ways of doing the same thing, to determine which method is the quickest, and should therefore be used in all circumstances.  Of course, true benchmarks are often extremely difficult, and so programmers are often forced to compare unlike-for-unlike.  However, the major differences between like-for-like and unlike-for-unlike are usually negligible, and so a good programmer can almost always simplify a complex comparison into a very straight race between two arbitrary pieces of code, and interpret the results correctly.  This simplification is done in much the same way that a physicist simplifies complex problems to simple ones using spherical cows in a&amp;nbsp;vacuum.&lt;/p&gt;
&lt;h3&gt;The Importance of&amp;nbsp;Whitespace&lt;/h3&gt;
&lt;p&gt;The first misconception that many programmers have is that whitespace makes no difference.  While in most cases, good compilers can optimize away whitespace, and sometimes even remove it entirely from the resulting binary, it can still make a large difference to compile-times, and as programmers need to spend at least 97% of their time optimising, decreasing the length of time that a programmer needs to wait to compile a program is always a good thing.  Of course, this is to say nothing of interpreted programs, where there is no compilation stage, and so the whitespace cannot ever be optimized away, and must remain during the final execution of the&amp;nbsp;program.&lt;/p&gt;
&lt;p&gt;The best way to demonstrate this is with a benchmark.  Consider the programs fast.c and slow.c (these are available on Github &lt;a href="https://github.com/MrJohz/benchmarks/tree/master/whitespace"&gt;here&lt;/a&gt;, although I would encourage you not to actually open slow.c unless you like dealing with very large text files).  They both do the same thing - print out &amp;#8220;Hello, World!&amp;#8221;.  However, they have radically different compile times because of the amount of whitespace involved.  If we run the &lt;code&gt;make&lt;/code&gt; command, we can get the output, which includes timings of individual portions as performed by &lt;code&gt;gcc&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;$&lt;/span&gt; make
&lt;span class="go"&gt;Fast implementation (no whitespace)&lt;/span&gt;
&lt;span class="go"&gt;wc -c fast.c&lt;/span&gt;
&lt;span class="go"&gt;104 fast.c&lt;/span&gt;
&lt;span class="go"&gt;gcc -time fast.c&lt;/span&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; cc1 0.02 0.00
&lt;span class="gp"&gt;#&lt;/span&gt; collect2 0.02 0.00

&lt;span class="go"&gt;Slow implementation (some whitespace)&lt;/span&gt;
&lt;span class="go"&gt;wc -c slow.c&lt;/span&gt;
&lt;span class="go"&gt;86124463 slow.c&lt;/span&gt;
&lt;span class="go"&gt;gcc -time slow.c&lt;/span&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; cc1 0.18 0.04
&lt;span class="gp"&gt;#&lt;/span&gt; collect2 0.02 0.00
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here it is very easy to see that having to parse 83 thousand times the amount of bytes actually made the second implementation slightly slower to compile!  This is of huge importance in our files.  While we may not always notice the speed difference in our day-to-day programming experience, it is always good practice to use as little whitespace as possible when writing programs.  As I mentioned earlier, this applies to both compiled programs and interpreted programs, although the difference for the latter is much greater, as the performance hit will actually occur during runtime.  What you may not know (and what hasn&amp;#8217;t been demonstrated here, but is left as an exercise to the reader) is that this also applies to comments as well - this is in fact the main reason for the &amp;#8220;self-documenting code&amp;#8221; movement, as repeating the documentation both in the code itself, and in comments alongside the code, is known to slow down character-by-character file input by as much as 200% (for perfectly balanced code/comment&amp;nbsp;combinations).&lt;/p&gt;
&lt;h3&gt;Interpreted vs&amp;nbsp;Compiled&lt;/h3&gt;
&lt;p&gt;Another important area of concern for programmers is the debate between interpreted languages and compiled languages.  Essentially, interpreted programming languages do all of the work when they are run, whilst compiled programming languages do some work at compile-time, and some work at runtime.  This would suggest that compiled programming languages are generally faster when being run, as they have to do less work at runtime.  The issue with this naive understanding of programming is that it doesn&amp;#8217;t take into account the amount of work done at compile-time.  Proper benchmarking should include all stages of a program&amp;#8217;s execution, even the stages before it&amp;#8217;s actually started to&amp;nbsp;execute.&lt;/p&gt;
&lt;p&gt;There is also a middle ground between compiling a programming and directly interpreting a program.  Many modern interpreters are actually &amp;#8220;&lt;span class="caps"&gt;JIT&lt;/span&gt;&amp;#8221; compilers, which do both compilation and interpretation at the same time, at runtime.  While they still have to do all of the work at runtime, they are able to do extra work making other parts of the program take less work.  The aim is that eventually the amount of work that is saved will be greater than the amount of extra work that is required, but it is doubtful if this will ever happen.  Many computer experts believe that &lt;span class="caps"&gt;JIT&lt;/span&gt; compilers will remain in the realm of fantasy and academia for many years to come.  However, in the interests of fairness, we will also use a &lt;span class="caps"&gt;JIT&lt;/span&gt; compiler in our&amp;nbsp;benchmarking.&lt;/p&gt;
&lt;p&gt;Our test will be a simple &amp;#8220;Hello, World!&amp;#8221; example - that is, all three programs (compiled, interpreted and &lt;span class="caps"&gt;JIT&lt;/span&gt;-interpreted) should simply print out the phrase &amp;#8220;Hello, World!&amp;#8221;.  While this is generally an extremely simple task, we will easily be able to extrapolate from the results any conclusion that we would like to draw.  The programming languages that we shall use will be C++ (compiled using &amp;#8220;g++ (Ubuntu 4.8.2-19ubuntu1) 4.8.2&amp;#8221;, whatever that means); Python (interpreted using &amp;#8220;CPython 3.4.2&amp;#8221;); and Python again (this time &lt;span class="caps"&gt;JIT&lt;/span&gt; compiled using &amp;#8220;Python 3.2.5&amp;#8221;).  As we said previously, a good benchmark should compare all parts of a program&amp;#8217;s lifetime, so we will measure the length of time it takes the C++ program to compile, as well as the execution time for all the programs.  As in the previous test, the test-code is available on &lt;a href="https://github.com/MrJohz/benchmarks/tree/master/int-comp"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;$&lt;/span&gt; make
&lt;span class="go"&gt;C++ version&lt;/span&gt;
&lt;span class="go"&gt;../benchmarker.py -n20 &amp;quot;g++ helloworld.c -ohelloworld &amp;amp;&amp;amp; ./helloworld&amp;quot;&lt;/span&gt;

&lt;span class="go"&gt;------------------------------ &lt;/span&gt;
&lt;span class="go"&gt;   g++ helloworld.c -ohelloworld &amp;amp;&amp;amp; ./helloworld&lt;/span&gt;
&lt;span class="go"&gt; max/min:    0.07519780099755735     0.053425493999384344&lt;/span&gt;
&lt;span class="go"&gt; mean ave:   0.06308976999989682&lt;/span&gt;
&lt;span class="go"&gt; median ave:     0.06266852850058058&lt;/span&gt;
&lt;span class="go"&gt;------------------------------&lt;/span&gt;
&lt;span class="go"&gt;CPython version&lt;/span&gt;
&lt;span class="go"&gt;../benchmarker.py -n20 &amp;#39;python -c &amp;quot;print(\&amp;quot;Hello, World\&amp;quot;)&amp;quot;&amp;#39;&lt;/span&gt;

&lt;span class="go"&gt;------------------------------ &lt;/span&gt;
&lt;span class="go"&gt;   python -c &amp;quot;print(\&amp;quot;Hello, World\&amp;quot;)&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt; max/min:    0.0267868869996164      0.023469741001463262&lt;/span&gt;
&lt;span class="go"&gt; mean ave:   0.02465028059996257&lt;/span&gt;
&lt;span class="go"&gt; median ave:     0.02490398199915944&lt;/span&gt;
&lt;span class="go"&gt;------------------------------&lt;/span&gt;
&lt;span class="go"&gt;PyPy version&lt;/span&gt;
&lt;span class="go"&gt;../benchmarker.py -n20 &amp;#39;pypy -c &amp;quot;print(\&amp;quot;Hello, World\&amp;quot;)&amp;quot;&amp;#39;&lt;/span&gt;

&lt;span class="go"&gt;------------------------------ &lt;/span&gt;
&lt;span class="go"&gt;   pypy -c &amp;quot;print(\&amp;quot;Hello, World\&amp;quot;)&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt; max/min:    0.22487263600123697     0.16340099499939242&lt;/span&gt;
&lt;span class="go"&gt; mean ave:   0.20837249334999797&lt;/span&gt;
&lt;span class="go"&gt; median ave:     0.21045488100025977&lt;/span&gt;
&lt;span class="go"&gt;------------------------------&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The statistics here are extremely clear - interpreted programs actually run faster than compiled programs, if you include the compilation time.  What is interesting - albeit not necessarily unexpected - to note is that the pypy attempt took on average nearly ten times as long as the CPython attempt.  As I said earlier, &lt;span class="caps"&gt;JIT&lt;/span&gt; compilers are very much in the realm of academia currently, and we are unlikely to see one of these outperform a proper programming language implementation in the next&amp;nbsp;decade.&lt;/p&gt;
&lt;p&gt;While not specifically tested in this particular test, it&amp;#8217;s also important to note that both of the Python programs were significantly shorter than the C++ program, and could indeed be sent to the interpreter as a single line.  On the other hand, the C++ program had to be written in a separate file, and even the command itself had more text on it.  The upshot of this is that the C++ program contains more whitespace - of course, in this benchmark that probably isn&amp;#8217;t a huge factor, but experience programmers should be wise to the fact that Python&amp;#8217;s terseness often offers a not insignificant speed&amp;nbsp;bonus.&lt;/p&gt;
&lt;h3&gt;Direct&amp;nbsp;Comparison&lt;/h3&gt;
&lt;p&gt;Of course, these are just specific features of individual programming languages that we have been comparing so far.  In many cases, we want to know how the overall program would perform in a real-life situation.  This will often require large and extensive benchmarks that compare a number of different programming languages.  One of the big pitfalls that many of these benchmarks fail to avoid is the use of idiomatic programming features.  In most languages, there is a &amp;#8220;right&amp;#8221; way to do things and a &amp;#8220;wrong&amp;#8221; way to do things.  For example, the Java &lt;span class="caps"&gt;JVM&lt;/span&gt; is extremely versatile when it comes to loops, as it can make these run as efficiently as possible.  However, many Java users fail to realise this, and there is a lot of lost potential in many Java programs.  For example, most naive Java users would write a method that adds two numbers like&amp;nbsp;so:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;slowAdd&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In actual fact, idiomatic Java would look much more like&amp;nbsp;this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;fastAdd&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;++;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This will work much faster, due to the &lt;span class="caps"&gt;JVM&lt;/span&gt;&amp;#8217;s affinity for looping&amp;nbsp;constructs.&lt;/p&gt;
&lt;p&gt;Of course, the differences between programming languages often goes a lot further than the best way to add different numbers together.  Most programming languages were designed for completely different purposes, and as a result testing them all in exactly the same way is usually the wrong way to do benchmarks.  Instead, the challenges given to each programming languages (and the method used to complete the challenge) should be specifically designed for each programming language.  Of course, to maintain independence, each programming language should be measured in exactly the same way, otherwise the results would be&amp;nbsp;incomparable.&lt;/p&gt;
&lt;p&gt;In our comparison, we&amp;#8217;ll test Python, Java, and Perl, attempting to write the most idiomatic code possible to ensure that each language has the best possible chance.  The source code for this test will not be on GitHub, as anyone fluent in these languages should be writing these things every day, and there really is no need to bombard you with thing that I&amp;#8217;m sure you already&amp;nbsp;know.&lt;/p&gt;
&lt;p&gt;In our Python program, we will be attempting to write the most commonly written Python program, &lt;code&gt;print("Hello, World!")&lt;/code&gt;.  Many people would question the use of such a basic test, but the huge number of people who demonstrate this piece of code as evidence of Python&amp;#8217;s simplicity and versatility in all things cannot be called into question.  Ultimately, if you can write the Hello, World! Python program, you can write any piece of Python code at all, as long as it solely involve printing out a string.  As a result, this is the benchmark code I will&amp;nbsp;use.&lt;/p&gt;
&lt;p&gt;On the other hand, very serious people use Java to do very serious things, and so to trivialise the language to simply printing out a string would be to do the Java community a huge disservice.  Instead, our benchmark Java code will create a server, and wait indefinitely for a response.  This is basically the code that most Java experts write every day.  Unfortunately it will not be &lt;em&gt;truly&lt;/em&gt; idiomatic Java, as that would require a huge number of Java classes that I honestly can&amp;#8217;t be bothered to write just for the sake of a cheap shot, especially as it&amp;#8217;s been done &lt;a href="https://github.com/EnterpriseQualityCoding/FizzBuzzEnterpriseEdition"&gt;before&lt;/a&gt;.  It is arguable that the Java code will be unable to stop, as it will hang forever until it receives a quit signal at the terminal.  To be honest, I think this just makes it more and more clear how slow idiomatic Java code is.  Also buggy.  Java code is probably buggy too.  It&amp;#8217;s still cool to hate Java,&amp;nbsp;right?&lt;/p&gt;
&lt;p&gt;Finally, we have our Perl program.  Perl is designed to be as quick as possible, by omitting any extraneous necessities like readability.  No-one is quite sure what idiomatic Perl programs should actually do, as it is difficult to remember the exact invocation syntax for that Perl script you wrote several years ago that you&amp;#8217;re quite sure did something with &lt;span class="caps"&gt;XML&lt;/span&gt; files, but you&amp;#8217;re not really sure &lt;em&gt;what&lt;/em&gt;.  Of course, you could just read the source, but to be honest it would probably be easier to rewrite the whole thing rather than dabble in that sort of black magic and&amp;nbsp;wizardry.&lt;/p&gt;
&lt;p&gt;It turns out that the idiomatic Perl program doesn&amp;#8217;t actually work.  I&amp;#8217;m 90% certain I wrote everything write, so I&amp;#8217;m going to blame the Perl interpreter.  Perl is, after all, notoriously difficult to read, and everyone knows that computers are fairly&amp;nbsp;stupid.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Basically, Python won.  Also Dumbledore dies at the end.  Spoiler." src="http://i.imgur.com/1kccxn5.png" /&gt;&lt;/p&gt;
&lt;p&gt;In the end, it appears that Python won both of the benchmarks that it was involved in, compared to C, and also compared to Java and Perl.  A basic interpretation of these results would suggest that, when writing programs that print out &amp;#8220;Hello, World!&amp;#8221;, Python is extremely strong.  We can also quickly extrapolate from this that Python is probably the best language in the world for most of the world&amp;#8217;s problems.  Thankfully, as a Python programmer, I have basically just proved exactly what I knew already - I mean, it would be a bit shocking if it suddenly turned out I&amp;#8217;d been wrong,&amp;nbsp;eh?&lt;/p&gt;
&lt;p&gt;Thanks for reading this short, humble, but extremely accurate blog on proper benchmarking practice.  There are a lot of people on the internet who are producing very dangerous and misleading benchmarks, that encourage people down dangerous paths, such as trying silly languages, just because they appear to beat certain things on certain benchmarks.  As I have clearly shown here, there is a right way to interpret benchmark results, and a wrong way.  I encourage you to share this with your friends, family, and strangers that you meet on the street, and particularly with those who persist in producing irrelevant and silly benchmarks simply for the sake of&amp;nbsp;comparison.&lt;/p&gt;
&lt;p&gt;Python for&amp;nbsp;life!&lt;/p&gt;</summary><category term="coding"></category><category term="benchmarks"></category><category term="humour"></category></entry><entry><title>The Definitive Guide to Copying and Pasting in JavaScript (the other kind…)</title><link href="https://mrjohz.github.io/posts/2014/Dec/19/the-definitive-guide-to-copying-and-pasting-in-javascript/" rel="alternate"></link><updated>2014-12-19T20:54:32+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2014-12-19:posts/2014/Dec/19/the-definitive-guide-to-copying-and-pasting-in-javascript/</id><summary type="html">&lt;h2&gt;Step 1:&amp;nbsp;Don&amp;#8217;t.&lt;/h2&gt;
&lt;p&gt;Stop.  You don&amp;#8217;t want flashing lights.  You don&amp;#8217;t want snowflake all over your page.  You don&amp;#8217;t want a trail of happy faces that will follow your cursor all around your page.  We left these things in decades past for a reason, dammit!  Keep them there, for all our sakes.  No copy and paste!  Ever!  No, no, no, no,&amp;nbsp;no!&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;Well, yes, sometimes there is a reason to copy and paste text from the internet, particularly if you&amp;#8217;re learning.  Sometimes you&amp;#8217;re looking for a bit of advice on the perfect way to memoize some functions, or a quick and easy method to merge two objects, or even just a couple of basic string functions that you really wish had appeared in earlier EMCAScript specs.  In these cases, finding a quick &amp;#8220;cookbook recipe&amp;#8221; on the internet can be a great convenience.  Often, it&amp;#8217;s a really good way for newer developers to expand their understanding of some of the language shortcuts.  The question then is &amp;#8220;how should I best learn from this recipe?&amp;#8221;  For you, then, comes step&amp;nbsp;two.&lt;/p&gt;
&lt;h2&gt;Step 2: Do it&amp;nbsp;well.&lt;/h2&gt;
&lt;h3&gt;Never copy-and-paste, always&amp;nbsp;rewrite.&lt;/h3&gt;
&lt;p&gt;I remember a book I once got given called &lt;em&gt;&amp;#8220;Hello, World!&amp;#8221;&lt;/em&gt;, written by Sande &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Sande (a father and son duo).  It was a Python programming introduction for &amp;#8220;Kids and other beginners&amp;#8221;.  Fairly near the start, they gave a listing for a program that was certainly larger than anything that I&amp;#8217;d seen up until that point that would let you play the classic skiing game where you have to ski down the mountain without hitting into things.  Of course, this being the technical age, they also provided a download for all the programs featured in the book, but this one came with a special&amp;nbsp;note.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The code for listing 10.1 is in the &lt;code&gt;\examples\skier&lt;/code&gt; folder, so if you get stuck or just don&amp;#8217;t want to type it all in, you can use that file.  But believe it or not, you&amp;#8217;ll learn more by typing it in than by just opening and looking at the&amp;nbsp;listing.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So of course I typed the whole file in, and it came up with an error, because I wasn&amp;#8217;t very good at coding, and didn&amp;#8217;t understand what most of it actually did or meant&lt;sup id="fnref:pythonfailure"&gt;&lt;a class="footnote-ref" href="#fn:pythonfailure" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;.  However, I did start to piece together what the thing was actually meant to do.  I could read the names and the comments in the sidebar, and together I could get a feel for what sort of magic a line like &lt;code&gt;pygame.image.load(image_file)&lt;/code&gt; might actually do.  (For the unitiated: it loads an image from an image file.  It&amp;#8217;s part of the pygame system.  This is not hard stuff, but when you&amp;#8217;re beginning it feels&amp;nbsp;amazing&amp;#8230;)&lt;/p&gt;
&lt;p&gt;What &lt;em&gt;&amp;#8220;Hello, World!&amp;#8221;&lt;/em&gt; had taught me in that small example was how to read code.  The way you read code is to go through each line individually.  This is probably not surprising for most well-practised developers, but in my various experiences of learning programming, reading code (and the sister-skill of thinking like a computer whilst doing so) are extremely&amp;nbsp;under-taught.&lt;/p&gt;
&lt;p&gt;This is the same when you are trying to use that useful function from the internet.  You &lt;em&gt;could&lt;/em&gt; just copy and paste it.  That will work, and get you developing quickly, and you can go home, have a delicious dinner, watch some superb television, have the most beautiful dream, and then wake up next morning with everything going wrong because you didn&amp;#8217;t quite understand that function you used, and it turns out it&amp;#8217;s caught on an edge case that - as the case may be - is actually quite common in your&amp;nbsp;circumstances.&lt;/p&gt;
&lt;p&gt;Of course, that&amp;#8217;s probably a rare example.  A lot of the functions that you paste are probably quite good, and will work quite well.  After all, StackOverflow is known for never ever being wrong ever.  However, it should always be on your mind that if you don&amp;#8217;t understand the code you&amp;#8217;re writing, it will always run the risk of jumping back at you and biting you.  When you write the function out, line-by-line, you&amp;#8217;ll quickly start to understand what cases this will deal with, and what cases this won&amp;#8217;t cope with.  You&amp;#8217;ll be able to see what guards exist, what format the function will return, and whatever other features the original creator put in but didn&amp;#8217;t&amp;nbsp;document.&lt;/p&gt;
&lt;h3&gt;Always change at least one&amp;nbsp;thing.&lt;/h3&gt;
&lt;p&gt;For me, this idea followed on quite easily from the previous piece of advice.  When you write out a piece of code, I find it relatively easy to just find little things that I want to change.  With JavaScript it&amp;#8217;s usually something as simple as turning snippets that extend an object&amp;#8217;s prototype into normal functions, as per &lt;a href="http://www.nczonline.net/blog/2010/03/02/maintainable-javascript-dont-modify-objects-you-down-own/"&gt;best practice&lt;/a&gt;.  With other languages, it might be something more complex, such as generalising a function designed for one case into a function designed for many cases.  You might dislike the specific formatting style that the example uses - change it.  Think you can use better variable names?  Use them.  Hell, if you&amp;#8217;re just copying in an algorithm that you&amp;#8217;re not entirely sure you grasp, try covering it in comments until you can see exactly what each line is there for.  (Admittedly, overuse of this particular example is probably a particularly bad idea, so if you find yourself doing this a lot, try finding less complex algorithms to do the same thing.  Alternatively, this might be the time you start looking for a well-maintained third-party library where someone else is doing all the&amp;nbsp;legwork.)&lt;/p&gt;
&lt;p&gt;Take for example, this beautiful JavaScript function that returns a repeated&amp;nbsp;string:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// This version will actually work thanks to&lt;/span&gt;
&lt;span class="c1"&gt;// http://www.reddit.com/r/javascript/comments/2pwz7l/the_definitive_guide_to_copying_and_pasting_in/cn0z7lm&lt;/span&gt;
&lt;span class="c1"&gt;// Modified from http://stackoverflow.com/questions/1235179/simple-way-to-repeat-a-string-in-java&lt;/span&gt;
&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;repeat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;repeat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Some things I can easily do.  For example, this is using prototypes, and it isn&amp;#8217;t even using them well.  It&amp;#8217;s also using the fact that &lt;code&gt;if&lt;/code&gt; can take a statement rather than a brace of statements.  Personally, I don&amp;#8217;t like that, except for rare cases, and I&amp;#8217;m not of the opinion that this is a rare enough case.  If I want to make it a stand-alone function, I&amp;#8217;ll also need to change the name to make it clear that this is repeating a string.  Let&amp;#8217;s see what it looks like&amp;nbsp;now:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;repeatStr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;times&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;repeatStr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;str&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;repeatStr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To me, that looks a bit better.  But I&amp;#8217;m still not sure what this function actually does.  I know it repeats strings, but what sort of magic is there under the hood?&lt;sup id="fnref:obtuse"&gt;&lt;a class="footnote-ref" href="#fn:obtuse" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt;  This is the best time to start adding comments in.  Let&amp;#8217;s smother that function.  We&amp;#8217;ll also re-add the most important part of any copy-and-paste code: the attribution.  This is partly because your source clearly deserves the recognition, but mainly because - as with the rest of your code - you&amp;#8217;ll probably come back later and wonder why you were so stupid as to write that.  At least when you can attribute parts of your code to others, it&amp;#8217;s not your fault.  (We&amp;#8217;ll discuss attribution slightly more properly a bit later&amp;nbsp;on.)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// Modified from http://stackoverflow.com/questions/1235179/simple-way-to-repeat-a-string-in-java&lt;/span&gt;
&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;repeatStr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;times&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="c1"&gt;// if no times needed&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;     &lt;span class="c1"&gt;// return empty string&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;                 &lt;span class="c1"&gt;// if times is even&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;repeatStr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;str&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;  &lt;span class="c1"&gt;// divide time by two, double str&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;                                                          &lt;span class="c1"&gt;// if times is odd&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;repeatStr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;times&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;  &lt;span class="c1"&gt;// divide time by two, double str, add str for remainder&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Do you begin to understand how it works a bit&amp;nbsp;now?&lt;/p&gt;
&lt;h3&gt;Always find an&amp;nbsp;alternative.&lt;/h3&gt;
&lt;p&gt;StackOverflow is a beautiful thing.  However, it is also a relatively fractured thing, and the sum of knowledge within it is built from many different parts, with opinions that can often appear to contradict each other.  This is the wonder of any system where opinions are crowd-sourced, and is why you should never trust the word of random blogs posted on link aggregation sites that claim to have all the answers.  There are always&amp;nbsp;alternatives.&lt;/p&gt;
&lt;p&gt;This is a good thing, because it means you&amp;#8217;ve got to think for a bit.  Say you find a function on the internet that claims to repeat a string.  Say you find two, or three, or many functions.  At some point you&amp;#8217;re going to need to decide between them.  And at that point you&amp;#8217;re going to need to understand how they work, and more specifically, why they may or may not be appropriate to&amp;nbsp;you.&lt;/p&gt;
&lt;p&gt;The best example here is probably a for loop, not because it&amp;#8217;s something that people regularly need to copy into their code, but because it&amp;#8217;s something that&amp;#8217;s so ubiquitous when it comes to optimization.  The standard mantra is that reverse for loops are the fastest loops, because back when programming required intimate knowledge of how a computer would spend each clock cycle, it was possible to implement a number of tricks in the computer hardware that could decrease the number of instructions used in each loop.  When you&amp;#8217;re writing code that requires every last drop of performance from the &lt;span class="caps"&gt;CPU&lt;/span&gt;, and touching the bones of the computer to do so, each extra clock cycle can be a beautiful and valuable&amp;nbsp;gift.&lt;/p&gt;
&lt;p&gt;Of course, none of this applies to JavaScript.  Despite this, there are a plethora of ways of looping available to budding web developers, each claiming to be the best, the fastest, the most optimised, and each providing their own set of benchmarks to back this up.  The question then becomes how to choose between them - which in turn becomes a question of what you&amp;#8217;re actually looking for in your for&amp;nbsp;loops.&lt;/p&gt;
&lt;p&gt;Of course, this will depend on what you need your for loop for.  Most of the time it will be fairly simple.  Perhaps you don&amp;#8217;t need absolute blazing speed, but you do need the code to look clear and concise.  In that case, your solution might be a &lt;code&gt;for x in xs&lt;/code&gt; loop, or perhaps &lt;code&gt;xs.forEach&lt;/code&gt;.  Or perhaps you need backwards compatibility across all browsers currently in use, and all browsers not in use that your boss still demands compatibility for.  In that case, the humble &lt;code&gt;for (...) { }&lt;/code&gt; loop is probably your best bet, and may god have mercy on your soul.  Maybe you&amp;#8217;re developing an application that demands absolute blazing speed of a kind never before seen in an interpreted scripting language.  In that case, I have no idea what the perfect solution is, but it&amp;#8217;s probably the sort of thing you&amp;#8217;ll find out after a long time spent with a huge number of benchmarking&amp;nbsp;suites.&lt;/p&gt;
&lt;p&gt;This in turn has parallels for finding recipes on the internet.  You want to use the best tool for the job, and to do that you need to understand what jobs any snippets you find are.  In my experience the best way to do that is to find alternatives, and to compare and contrast.  You won&amp;#8217;t be able to tell why snippet &lt;em&gt;a&lt;/em&gt; is so good unless you know about its direct competitor &lt;em&gt;b&lt;/em&gt;.  This way you&amp;#8217;ll be able to expand your knowledge, and understand more easily what the text you&amp;#8217;re copying into your code will actually&amp;nbsp;do.&lt;/p&gt;
&lt;h2&gt;Step 3:&amp;nbsp;&amp;#8230;Profit?&lt;/h2&gt;
&lt;p&gt;Of course, all this advice is given with the aim of learning how to be a better programmer.  Over time, if you are repeatedly copying the same pieces of code into your project, that there&amp;#8217;s probably a greater issue somewhere.  In some languages it might well be that you&amp;#8217;re using the wrong idioms (creating a map where an enum-type would be more helpful, or complex case statements where a map would be more useful).  In other languages where the problem is more the lack of a standard library, the solution might be to find a third-party library that you can use consistently.  With JavaScript, the latter case is often true, and it may well be that learning how to effectively use tools such as &lt;a href="https://lodash.com/"&gt;lodash&lt;/a&gt; and &lt;a href="http://underscorejs.org/"&gt;underscore&lt;/a&gt; will help you a lot.  However, for those who are taking early steps in a language, I&amp;#8217;d argue that copying and pasting is not wrong - as long as you do it&amp;nbsp;properly.&lt;/p&gt;
&lt;h2&gt;Step 4 and Step 0:&amp;nbsp;Attributions!&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://www.reddit.com/user/jimschubert"&gt;/u/jimschubert&lt;/a&gt; reminded me in the discussion on this post on Reddit that one important thing to do that I didn&amp;#8217;t properly emphasise is to attribute your stuff properly (and even determine if you&amp;#8217;re allowed to use it).  I did briefly mention when I talked about changing the code that it&amp;#8217;s always good to put a comment saying where you got the code from, but proper attribution is an interesting legal issue.  For many things (particularly in web-development and Java applications), you&amp;#8217;ll probably find your snippets from Stack Overflow.  Stack Overflow puts everything it hosts under the Creative Commons &lt;a href="http://creativecommons.org/licenses/by-sa/3.0/"&gt;&lt;span class="caps"&gt;CC&lt;/span&gt; &lt;span class="caps"&gt;BY&lt;/span&gt;-&lt;span class="caps"&gt;SA&lt;/span&gt; 3.0&lt;/a&gt; license.  Generally, this allows you to do with the content what you like, as long as you give &amp;#8220;appropriate credit&amp;#8221; (indicating if you changed it), and distribute any modifications under the same (or a compatible)&amp;nbsp;license.&lt;/p&gt;
&lt;p&gt;The other big source of snippets is blog posts and technical articles.  If the article is an &amp;#8220;official source&amp;#8221; (for example examples on the Mozilla &lt;span class="caps"&gt;JS&lt;/span&gt; docs), or a large enough software organisation they will probably have a note at the bottom of the page that gives you the official state of licensing for any information on that site.  (In the case of the &lt;span class="caps"&gt;MDN&lt;/span&gt; pages, code samples are either under the &lt;span class="caps"&gt;MIT&lt;/span&gt; license, or in public domain, while the rest of the text is under the &lt;span class="caps"&gt;CC&lt;/span&gt; &lt;span class="caps"&gt;BY&lt;/span&gt;-&lt;span class="caps"&gt;SA&lt;/span&gt; 2.5 license.)  For smaller blogs that haven&amp;#8217;t thought about this issue, the issues are slightly more complex.  There are generally two schools of thought, one stating that if there&amp;#8217;s no license, it&amp;#8217;s in the public domain, and the other stating that in the absence of a license, it should be assumed that all rights are reserved.  It&amp;#8217;s probably a good rule of thumb that someone releasing unlicensed code into the world does consider it public domain (this has always been my assumption, although having researched this little section, I realise it would probably be wise for me to think about licensing code snippets on my blog more carefully).  However, if you&amp;#8217;re writing code on behalf of a company with concerns about being sued, the general feeling is usually that unlicensed code isn&amp;#8217;t really worth&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;This, then would be my advice, partly built on trying to abide by the complicated legal issues, and partly built on just trying to be as nice as possible to the original&amp;nbsp;authors:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Always provide attributions and the source.  I don&amp;#8217;t know of any license that forbids them, and it&amp;#8217;s polite to do so.  Plus, as I said earlier, you can always blame other&amp;nbsp;people.&lt;/li&gt;
&lt;li&gt;Always say if you&amp;#8217;ve modified the original.  (Of course, if you were following Step 2 properly, you&amp;#8217;ll always be modifying it&amp;nbsp;anyway!)&lt;/li&gt;
&lt;li&gt;If you can see a license, obey any further stipulations in that license.  Note that some &amp;#8220;viral&amp;#8221; licenses may affect how you license your own work.  If you can&amp;#8217;t abide by those licenses, you should not use the&amp;nbsp;code.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Again, I am not in any way, shape, or form a lawyer.  This is not legal advice.  But it&amp;#8217;s my opinion, and probably some decent practical advice that might work for&amp;nbsp;you.&lt;/p&gt;
&lt;h2&gt;Side note about the&amp;nbsp;title:&lt;/h2&gt;
&lt;p&gt;It&amp;#8217;s based on &lt;a href="https://www.lucidchart.com/techblog/2014/12/02/definitive-guide-copying-pasting-javascript/"&gt;this&lt;/a&gt; article submitted to the &lt;a href="http://www.reddit.com/r/javascript"&gt;&lt;code&gt;/r/javascript&lt;/code&gt;&lt;/a&gt; sub on Reddit.  That article is a very interesting one about how to use the clipboard from a JavaScript application in a cross-browser way, and is very interesting, but it did confuse me for a while as I did manage to get the wrong impression from the title.  For those people like me, who are easily confused by these simple matters, I submit this blog post, which might not&amp;nbsp;help.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:pythonfailure"&gt;
&lt;p&gt;If I remember correctly, I got really irritated at that point, angrily turned the computer off, stormed off to my room, and didn&amp;#8217;t come down for the rest of the day.  My poor father who&amp;#8217;d been trying to please my yearning to become a programmer must&amp;#8217;ve been really quite worried - thankfully that didn&amp;#8217;t deter me significantly, and while I never got that code to work, I did continue learning Python.&amp;#160;&lt;a class="footnote-backref" href="#fnref:pythonfailure" rev="footnote" title="Jump back to footnote 1 in the text"&gt;[back]&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:obtuse"&gt;
&lt;p&gt;You might think this is me being obtuse.  This is a real snippet that I copied recently in Java.  I could see why it would be efficient (it doubles the length each time, rather than adding each string individually), but it took a while to connect in my head how exactly it worked, particular for cases that weren&amp;#8217;t multiples of two.  By putting comments everywhere, I started to understand very clearly what each line was doing.&amp;#160;&lt;a class="footnote-backref" href="#fnref:obtuse" rev="footnote" title="Jump back to footnote 2 in the text"&gt;[back]&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary><category term="coding"></category><category term="javascript"></category></entry><entry><title>I Made A Thing. Then I Learned Some More Things.</title><link href="https://mrjohz.github.io/posts/2014/Jul/16/i-made-a-thing-then-i-learned-some-more-things/" rel="alternate"></link><updated>2014-07-16T10:35:18+01:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2014-07-16:posts/2014/Jul/16/i-made-a-thing-then-i-learned-some-more-things/</id><summary type="html">&lt;p&gt;I made a &lt;a href="http://wfe.johz.me"&gt;thing&lt;/a&gt;.  The thing is called &amp;#8220;The &lt;span class="caps"&gt;WFE&lt;/span&gt; Thing&amp;#8221;, because I am unoriginal with names.  It is a thing for WFEs, which are World Factbook Entries, which are a part of a not-particularly-famous game called &lt;a href="http://www.nationstates.net/"&gt;NationStates&lt;/a&gt;.  The importance of WFEs is hard to understand unless you understand raiding and defending in NationStates, and even then one could very easily fail to recognise the necessity of the tool I have constructed.  Essentially, sometimes bad people delete other people&amp;#8217;s data, but this is entirely legal and acceptable in the game.  To counter this, other people come along afterwards and undo it, not because they have to as moderators or admins, but out of the fun of doing so, and out of care for the people whose data was deleted.  The &lt;span class="caps"&gt;WFE&lt;/span&gt; Thing records some (but not all) of this data from historical points so that it can be accessed easily at any time.  If this makes any sense to you at all, you&amp;#8217;re a better person than&amp;nbsp;me.&lt;/p&gt;
&lt;p&gt;But enough about NationStates, let&amp;#8217;s talk about The &lt;span class="caps"&gt;WFE&lt;/span&gt; Thing, because it was fun to make and I need an excuse to write a blog post because I&amp;#8217;ve been really missing it&amp;nbsp;recently.&lt;/p&gt;
&lt;p&gt;The need for a historical list of WFEs (just think of this as a more regular, specific version of the &lt;a href="http://archive.org/web/"&gt;Wayback Machine&lt;/a&gt;) has produced multiple versions of The &lt;span class="caps"&gt;WFE&lt;/span&gt; Thing.  The original was created by a lovely chap named Solm, in &lt;span class="caps"&gt;PHP&lt;/span&gt;, and it generally worked really well, until at some point it stopped working.  At that point, I decided that I could make my own one.  This was around the time that I had been making this blog, and what I really like about this blog is that it is entirely static, and yet the Javascript on it gives it a lovely dynamic feel.  So I wondered if I could make a &lt;span class="caps"&gt;WFE&lt;/span&gt; thing that was entirely static except for a javascript-based&amp;nbsp;frontend.&lt;/p&gt;
&lt;p&gt;The basic idea was that if pages could be static files, so could too could the &lt;span class="caps"&gt;API&lt;/span&gt; a set of static .json files in an &lt;code&gt;api/&lt;/code&gt; directory somewhere.  There&amp;#8217;s a lot of merit to this idea in many respects.  If you use traditional server software such as &lt;a href="http://www.apache.org/"&gt;Apache&lt;/a&gt; or &lt;a href="http://wiki.nginx.org/Main"&gt;Nginx&lt;/a&gt;, you&amp;#8217;ve already got a system that is extremely optimised for throwing files down the right tubes to make a website.  Things go quickly, but they also go efficiently, which, when you have a site with a lot of load, means things break a lot less.  Now I didn&amp;#8217;t expect to recieve a lot of load, but the idea of high speeds without much work appealed to my naive sensibilities, and so the second &lt;span class="caps"&gt;WFE&lt;/span&gt; thing was&amp;nbsp;convieved.&lt;/p&gt;
&lt;p&gt;There are, however, a lot of reasons why one would use a database over keeping data in the filesystem.  The first of these is that a database usually has a very sensible and clever query language or &lt;span class="caps"&gt;API&lt;/span&gt; to go with it.  For example, when I obtain a new piece of data, I want to attach it to the correct file.  Because in my case the data doesn&amp;#8217;t change very often, I also don&amp;#8217;t want to repeat myself.  Specifically, if the new data is the same as the older piece of data, I want to save a &amp;#8220;null row&amp;#8221; into the system that identifies that this row is a duplicate of a previous row.  As a result, to decide if I want to save this particular piece of data, I can execute the following&amp;nbsp;query:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;myfield&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="n"&gt;mytable&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt;
    &lt;span class="n"&gt;dataname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;dataname&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt;
    &lt;span class="nb"&gt;date&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;inputdate&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt;
    &lt;span class="n"&gt;myfield&lt;/span&gt; &lt;span class="k"&gt;NOT&lt;/span&gt; &lt;span class="k"&gt;NULL&lt;/span&gt;
&lt;span class="k"&gt;ORDER&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="nb"&gt;date&lt;/span&gt; &lt;span class="k"&gt;DESC&lt;/span&gt;
&lt;span class="k"&gt;LIMIT&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here, I specify the name, and (because I don&amp;#8217;t necessarily insert data in chronological order) that the in-table data must come from before a particular date.  I also specify that the &lt;code&gt;myfield&lt;/code&gt; field isn&amp;#8217;t null, because if it is null then I know that this was a duplicate of a previous row, so I&amp;#8217;d need to continue searching anyway.  I can also add &lt;code&gt;LIMIT 1&lt;/code&gt;, which ensures that the database query stops as soon as it&amp;#8217;s found the relevant data.  Then I can test the value of &lt;code&gt;myfield&lt;/code&gt; against the data that I have just obtained, to decide if I need to add a new one.  It&amp;#8217;s simple, pretty quick (because almost all the logic is being performed by the highly-optimised database), and it works every&amp;nbsp;time.&lt;/p&gt;
&lt;p&gt;On the other hand, in a filesystem database with .json files, I need to put a lot more logic into my application to deal with this kind of query.  Here&amp;#8217;s a basic implementation in Python that attempts to do roughly the same&amp;nbsp;thing.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;items&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;lt;dataname&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;lt;inputdate&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt; &lt;span class="c"&gt;# We&amp;#39;re only looking at rows before inputdate&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;datavalue&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt; &lt;span class="c"&gt;# We don&amp;#39;t want null values&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;myfield&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c"&gt;# Assuming this is tucked into a function somehow&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This isn&amp;#8217;t very simple, and it does a lot of unnecessary work.  For a start, I need to access the entire file, even the parts of it that I have no interest in using.  For small files, this isn&amp;#8217;t much of an issue, but it&amp;#8217;s slow.  For larger files, there&amp;#8217;s a good chance that I&amp;#8217;m looking at a tiny fraction of the actual file, which is just wasteful.  Thankfully Python&amp;#8217;s sort functions are apparently very efficient, and the &lt;code&gt;key&lt;/code&gt; argument makes sorting by a particular field very easy.  However, I can&amp;#8217;t add conditions into my sort or selection here, so once the files have been sorted I&amp;#8217;ll also need to filter out rows that don&amp;#8217;t match my date criteria, (and at Python-speeds rather than the optimised &lt;span class="caps"&gt;SQL&lt;/span&gt;-speeds).  It&amp;#8217;s only then that I can actually return the small piece of data that I was looking&amp;nbsp;for.&lt;/p&gt;
&lt;p&gt;There are other problems with this, not least the fact that this particular piece of code relies on the &lt;span class="caps"&gt;JSON&lt;/span&gt; file being an array, rather than an object, which is actually a security risk in certain cases.  But the worst crime of all is that this snippet is so much longer than the other one to do exactly the same thing but slower.  Now of course this logic has been put into a function (hence the &lt;code&gt;return&lt;/code&gt; at the end), but if I&amp;#8217;m writing worse code to do a worse job, something&amp;#8217;s going&amp;nbsp;wrong.&lt;/p&gt;
&lt;p&gt;That&amp;#8217;s not the only difference between a file-system and a database.  For a start, if I&amp;#8217;m using &lt;span class="caps"&gt;JSON&lt;/span&gt;, I need to store the name of each field, and I need to store it in every single file on the system.  On the other hand, in a traditional &lt;span class="caps"&gt;SQL&lt;/span&gt; database I store the name of each field once (we&amp;#8217;ll ignore special cases like MongoDB and other NoSQL systems for now), and each row just needs a basic separator.  I could shorten the names of the json fields, or even convert each row to an array, but then I&amp;#8217;d need an encoding and decoding library on both sides of the app.  I also haven&amp;#8217;t begun to talk about locking and synchronisation issues.  In this case it probably isn&amp;#8217;t so bad, as there is only ever one person putting new data into the system at a time (that&amp;#8217;s me!).  As far as I can tell, the worst possible case is that in certain circumstances a user might get outdated data, which isn&amp;#8217;t a desperately troublesome issue for The &lt;span class="caps"&gt;WFE&lt;/span&gt; Thing.  Of course, in the general case, this may not be true at all, and if I&amp;#8217;d gone much further, I&amp;#8217;d probably end up missing the ACIDity of most &lt;span class="caps"&gt;SQL&lt;/span&gt;&amp;nbsp;databases.&lt;/p&gt;
&lt;p&gt;Despite all this, I do feel the need to point out that I can still see the case for a static &lt;span class="caps"&gt;API&lt;/span&gt; in very specific circumstances.  It&amp;#8217;s definitely more work, but it may be worth it.  There are a lot of optimisations that a clever load script could make, including ensuring the data is always pre-sorted rather than sorting it on the fly.  Indeed, I&amp;#8217;ve assumed that I should try to minimise the filesize in both cases, but if I knew I had the space, I could very easily save &lt;code&gt;myfield&lt;/code&gt; every single time, even if it was repeated data.  This is actually what I server to users, so that&amp;#8217;s another optimisation to&amp;nbsp;make.&lt;/p&gt;
&lt;p&gt;Why, then, did I use a &lt;a href="http://www.sqlite.org/"&gt;SQLite&lt;/a&gt; database as my primary storage mechanism in the end?  Because I was performing premature optimisations.  You can read more about why premature optimisations are the root of all evil by searching &amp;#8220;premature optimisation is the root of all evil&amp;#8221; anywhere.  Even Bing would be able to return some good advice.  However, you probably won&amp;#8217;t recognise the truth of the problem until you&amp;#8217;ve prematurely optimised yourself.  With that in mind, allow me to elucidate the situation where a static &lt;span class="caps"&gt;API&lt;/span&gt; might be&amp;nbsp;useful.&lt;/p&gt;
&lt;p&gt;The site needs to have a lot of visitors.  A hell of a lot of visitors.  Facebook-level visitors.  Enough visitors that even on the most secure and stable of servers (hell, even using NodeJS&amp;#8217; webscaleity) you&amp;#8217;re starting to be a bit worried.  You should also have a genuine worry about such things as DDoS attacks.  Your site also sends a lot of hits (hundreds, thousands) to the backend &lt;span class="caps"&gt;API&lt;/span&gt; with each request to the mainpage.  There&amp;#8217;s probably a lot of very rapid and heavy polling involved.  Your site is probably designed badly, but for some unknown reason you are unable to change that part of it.  Additionally (and this one is very important) only the backend triggers changes, and those changes occur infrequently.  We&amp;#8217;re also not talking about Big Data - there&amp;#8217;s not enough data that you&amp;#8217;re using several servers and need to worry about routing, and you also probably don&amp;#8217;t need to sort it in complex ways to understand the patterns within the&amp;nbsp;data.&lt;/p&gt;
&lt;p&gt;If you do find yourself in this situation&amp;#8230;  Get out of there as fast as you can.  Or you could try a static &lt;span class="caps"&gt;API&lt;/span&gt;.  If that &lt;em&gt;specific&lt;/em&gt; set of circumstances were to come&amp;nbsp;about.&lt;/p&gt;
&lt;p&gt;I would like to finish with a quick story that I hope suggests that I&amp;#8217;ve learned my lesson about premature optimisations, and might be of some interest to Python programmers.  The backend is now written in the beautiful (if somewhat overshadowed) &lt;a href="http://bottlepy.org/docs/dev/index.html#"&gt;Bottle&lt;/a&gt; microframework, which was great fun, especially as I got to use Python 3.4 (the best Python!).  Bottle makes deployment relatively easy, at is already has basic configurations for a number of Python &lt;span class="caps"&gt;WSGI&lt;/span&gt; servers.  (Think of Bottle as your &lt;span class="caps"&gt;PHP&lt;/span&gt; scripts, and the &lt;span class="caps"&gt;WSGI&lt;/span&gt; servers as your Apache setup - it&amp;#8217;s basically like that but completely different.)  Originally I was going to use the standard mod_wsgi setup on my webfaction server, but trying to set that up with the structure I currently had wasn&amp;#8217;t going very well, so I quickly Googled what the fastest &lt;span class="caps"&gt;WSGI&lt;/span&gt; server was.  (The answer, it turns out, is probably &lt;a href="https://github.com/jonashaag/bjoern"&gt;Bjoern&lt;/a&gt;.)  However, while looking for this, I found a few reports that suggested &lt;a href="http://meinheld.org/"&gt;Meinheld&lt;/a&gt; was quite good for combining speed with stability.  So, remembering my lesson about premature optimisation, I tested everything, quite thoroughly, against some of the slower servers.  Every server came out exactly the&amp;nbsp;same.&lt;/p&gt;
&lt;p&gt;The reason is quite obvious: I didn&amp;#8217;t need any async fanciness, because I wasn&amp;#8217;t going to get enough requests to merit anything so complex.  The users of this app will almost all access it between 6:00am - 1:00pm, 6:00pm - 1:am &lt;span class="caps"&gt;GMT&lt;/span&gt;.  There will be about five unique users in total, making perhaps 30-40 requests over that seven hour period on the rare busy day.  That&amp;#8217;s pretty much the entire usage I&amp;#8217;m expecting.  I don&amp;#8217;t need to optimise the speed of my server.  What I should, however, be optimising is how quickly I can make this site instead of leaving the users to struggle with my old broken attempts.  Additionally, I need to remember to optimise the usefulness of the &lt;span class="caps"&gt;UI&lt;/span&gt;.  Speed, for me, doesn&amp;#8217;t come into this, which means I have time to optimise the things that I forgot about last time in my quest for the fastest response.  Today I finally learned that premature optimisation is the root of all evil.  And more importantly, it makes things &lt;em&gt;hard&lt;/em&gt;.&lt;/p&gt;</summary><category term="coding"></category><category term="python"></category><category term="optimisation"></category></entry><entry><title>An Update, A Forecast, and some Waffles</title><link href="https://mrjohz.github.io/posts/2014/Feb/05/an-update-a-forecast-and-some-waffles/" rel="alternate"></link><updated>2014-02-05T22:02:39+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2014-02-05:posts/2014/Feb/05/an-update-a-forecast-and-some-waffles/</id><summary type="html">&lt;p&gt;I lied about the&amp;nbsp;waffles.&lt;/p&gt;
&lt;p&gt;What you&amp;#8217;re actually going to get is me waffling on for a bit.  It&amp;#8217;s almost the same thing, except not as edible, not very tasty, and it can&amp;#8217;t be smothered in chocolate sauce.  Like I said, I completely lied about the waffles, I just couldn&amp;#8217;t come up with a snappy sounding&amp;nbsp;title.&lt;/p&gt;
&lt;p&gt;So an update.  Update might be the wrong word, it&amp;#8217;s more a sort of reflective moody thing, where I pretend I&amp;#8217;ve regressed five years and am living in a pokey black-painted bedroom with heavy metal posters on all the walls and a general feeling of internal self-loathing.  That&amp;#8217;s right, I&amp;#8217;m taking a second adolescence, on the principle that it works for politicians and second&amp;nbsp;homes.&lt;/p&gt;
&lt;p&gt;To talk about updates, I&amp;#8217;d like to initially introduce my housemate, who we&amp;#8217;ll call Elgar because I really wish I knew someone who was called Elgar.  Despite being about as good at programming as I am at most athletics-based sports, he has this magic ability to come in and debug my code for me, often while scarcely understanding what it is that I&amp;#8217;m trying to do.  I like to call this the &amp;#8220;new eyes syndrome&amp;#8221;, because I&amp;#8217;m in a pretentious mood.  To give you an example, I spent a good hour trying to work out a where a segfault was coming from in some C++ code, when he walked in, took one look at my code, and told me that I was using the wrong input file.  It&amp;#8217;s a very helpful skill to have around as a coder, because when you get onto a particular coding path, you tend to forget the other ways of solving the problem.  Or at least that&amp;#8217;s how it works for&amp;nbsp;me.&lt;/p&gt;
&lt;p&gt;Anyway, earlier this afternoon, Elgar walked in and debugged my life, which was a slightly unsettling experience.  I can&amp;#8217;t quote you the exact words he said, because I have a memory like a sieve, but it was something along the lines of &amp;#8220;Why aren&amp;#8217;t you coding&amp;nbsp;anymore?&amp;#8221;&lt;/p&gt;
&lt;p&gt;That&amp;#8217;s a very good question, Elgar.  Why am I not coding anymore?  Also, should &amp;#8220;anymore&amp;#8221; be &amp;#8220;anymore&amp;#8221;, or &amp;#8220;any&amp;nbsp;more&amp;#8221;?&lt;/p&gt;
&lt;p&gt;With respect to the former (the latter is as of yet unsolved, please send a postcard if you think you know the answer), I think it&amp;#8217;s because I&amp;#8217;ve become a consumer, rather than a producer.  Most things operate on a simple principle: One person (or group of people) will produce, while other people (or person) will consume.  Take code.  I like to believe that most of my code is for an eventual consumer, who invevitable turns out to be either myself, or the hard drive as I forget all about the project and leave it rotting.  Or more generally, television is made by a producer (quite literally in this case, although a number of other people also take part in that role), and we as consumers consume&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;Once upon a time, I think I had a good grasp of the two sides of the story.  I consumed a handful of television shows, YouTube channels, comical blogs, and the Grand World of &lt;span class="caps"&gt;IRC&lt;/span&gt;, and I also enjoyed a bit of flash gaming on the side.  Yet I also wrote code and blog posts, and I actively took part in NationStates, which could be considered producing activity, but I&amp;#8217;m really just shoehorning it in there to make this rough, overextended analogy work.  On top of this, once upon a time, I actually did&amp;nbsp;work.&lt;/p&gt;
&lt;p&gt;These days, I play Minecraft and watch&amp;nbsp;videos.&lt;/p&gt;
&lt;p&gt;So what is this update?  Well, this update is to say that I&amp;#8217;ve started to begin to recognise this, and I&amp;#8217;d like to get back to actually doing some producing now.  It also leads directly into the&amp;nbsp;forecast.&lt;/p&gt;
&lt;p&gt;First off in my grand forecast of things to come in the next few weeks/months/years/millenia, I need to poke around with my &lt;span class="caps"&gt;WFE&lt;/span&gt; archive system, which is a NationStates thing but may or may not have some quite cool stuff in it.  Secondly, as I said, I&amp;#8217;ve been playing Minecraft, and the Exciting World of Modding has appeared before my eyes, and I am very tempted to start diving in, in no small part due to the fact that I really would like to get some java experience under my belt before I leave university, even if it is akin to drowning my eyeballs in vats of sulphur.  Thirdly, I want to blog more.  I was talking to someone on &lt;span class="caps"&gt;IRC&lt;/span&gt; about this recently, and it&amp;#8217;s a really fun and helpful thing to do.  It gets you used to writing large amounts of stuff consistently.  It gets you used to thinking about things properly.  Essentially, go and get a blog.  That will solve all the world&amp;#8217;s&amp;nbsp;problems.&lt;/p&gt;
&lt;p&gt;I would like to briefly say something about my own circumstances.  Next week, if all goes to plan, I shall be donating my stem cells to someone with leukemia.  It&amp;#8217;s quite scary, but it&amp;#8217;s quite exciting.  I get to go down to London, which despite being a city-boy myself, is still extremely exciting.  It won&amp;#8217;t be terribly painful, as these days most people donate via &lt;span class="caps"&gt;PBSC&lt;/span&gt;, which is essentially a prolongued blood donation, but where you get the blood back at about the same rate that you donate it.  I&amp;#8217;d like to encourage you, my dear reader (that&amp;#8217;s a very deliberate singular, there&amp;#8217;s definitely only one of you, hello Mum!) to think about joining the registry.  Eventually, I&amp;#8217;ll write up everything that happened to me, add a page on the blog, and offer round links to the bone marrow registry, but for now, here are two sites that you ought to explore:  &lt;a href="http://www.nhsbt.nhs.uk/bonemarrow/"&gt;The &lt;span class="caps"&gt;UK&lt;/span&gt; &lt;span class="caps"&gt;NHS&lt;/span&gt; site on bone marrow donation&lt;/a&gt;, and the &lt;a href="http://www.anthonynolan.org/"&gt;Anthony Nolan Foundation homepage&lt;/a&gt;, Anthony Nolan being the organisation that I&amp;#8217;m donating with.  I&amp;#8217;d really recommend checking those out, because it&amp;#8217;s one of those relatively small things you can do that will drastically improve - hell, let&amp;#8217;s be blunt, the word here is &lt;em&gt;save&lt;/em&gt; - someone&amp;#8217;s life.  Anyway, that&amp;#8217;s happening Monday &amp;#8216;til Wednesday, depending on how everything works out, so wish me luck, and/or pray for&amp;nbsp;me.&lt;/p&gt;</summary><category term="meta"></category><category term="working"></category></entry><entry><title>On Special Snowflakes and Rethinking Conclusions</title><link href="https://mrjohz.github.io/posts/2014/Jan/03/on-special-snowflakes-and-rethinking-conclusions/" rel="alternate"></link><updated>2014-01-03T12:59:34+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2014-01-03:posts/2014/Jan/03/on-special-snowflakes-and-rethinking-conclusions/</id><summary type="html">&lt;p&gt;My brother is a Special&amp;nbsp;Snowflake.&lt;/p&gt;
&lt;p&gt;Now before you complain (especially you, dear brother), please read this whole blog.  It may well get worse later on, but it will get better eventually.  Probably, at&amp;nbsp;least.&lt;/p&gt;
&lt;p&gt;The thing is, my brother has dyslexia.  How does he spell?  He doesn&amp;#8217;t.  That joke&amp;#8217;s funnier if you imagine I&amp;#8217;m telling the one about the dog with no nose, but unfortunately still not very funny at all.  As a family, we&amp;#8217;ve been aware that he&amp;#8217;s had dyslexia for a while now, and he has recieved support for it in many of his exams, but recently he&amp;#8217;s had an official assessment (a few hundred pound&amp;#8217;s worth of it, no less) and has been been given the official designation &amp;#8220;dyslexic&amp;#8221;.  My brother is officially a Special&amp;nbsp;Snowflake.&lt;/p&gt;
&lt;p&gt;I honestly didn&amp;#8217;t realise I had a problem with this until I found myself listening to the story for the hundredth time.  My brother is not a fantastic story teller (although certainly better at it than I am - I continue to feel sorry for anyone who is forced out of courtesy to be entertained by the pair of us) and the story tends to go on for a bit, which allows me some alone time with my thoughts.  (At least when I&amp;#8217;m not interupting him to destroy the story in my own special way.)  And I think I do have a problem&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;The issue is fundamentally with me (of course), and it lies in the fact that I like conformity.  I&amp;#8217;m not a fan of special snowflakes.  There are certain limitations on this.  I mean, when it comes to opinion, I firmly disagree with everything that anyone popular says by default, because I am a grumpy old (almost 20!) man.  However, in most other things, I am very keen on everyone staying the same.  I don&amp;#8217;t go around being special, why should&amp;nbsp;you?&lt;/p&gt;
&lt;p&gt;And let&amp;#8217;s face it, this kind of thinking seems harmless.  Conforming to a societal norm is something that we as social animals are good at, and something that presumably aids our survival as a species, or at least did once upon a time.  It gives us those unwritten laws like &amp;#8220;don&amp;#8217;t urinate in public&amp;#8221; and &amp;#8220;hitting people isn&amp;#8217;t nice, mkay?&amp;#8221;  The advice that our urge for conformancy offers tends to be extremely&amp;nbsp;helpful.&lt;/p&gt;
&lt;p&gt;Unfortunately, it isn&amp;#8217;t always quite as helpful as we want.  Right now I am doing something that I regularly enjoy doing, which is procrastinating.  This particular piece of procrastination is about an email I need to write to my university to inform them that I need to take a few days off.  Why is this so hard for me?  Because it feels like I&amp;#8217;m singling myself out as someone requiring different treatment.  Essentially, I would be someone who doesn&amp;#8217;t conform to societal norms - or at least the societal norms that I see around&amp;nbsp;me.&lt;/p&gt;
&lt;p&gt;I will resolve this issue momentarily - I really need to sort this email out tonight, and the threat of a deadline is a surefire way to motivate me - but it&amp;#8217;s still things like it that require a surprising amount of courage.  And this is simply to send an email the main point of which is to cover certain&amp;nbsp;bases.&lt;/p&gt;
&lt;p&gt;To put this in perspective, let&amp;#8217;s examine my brother&amp;#8217;s case.  He had to speak to a member of staff at his college, face-to-face, and request a ~£300 exam.  Based on previous, more informal tests, he was well aware that the result of his talk would be something along the lines of permanent support throughout his education at the college.  As it turned out, he has a scribe who will take down notes for him, and write down his answers in exams.  Not only did he single himself out to the Powers That Be, but he also marked himself differently amongst his peers.  And my brother did this because he knew that if he worried more about fitting in with society&amp;#8217;s mould, he would be unable to do the course he wanted to&amp;nbsp;do.&lt;/p&gt;
&lt;p&gt;Of course, when there are higher stakes, we take bigger risks, but I feel like it really puts me to shame.  I worry about being the odd one out.  I struggle in conversations with friends who don&amp;#8217;t know the finer points of the etiquette of discourse.  I am &amp;#8220;all things to all men&amp;#8221; simply to fit in and be like everyone&amp;nbsp;else.&lt;/p&gt;
&lt;p&gt;You may notice that I&amp;#8217;ve stayed away from some of the real battles against society&amp;#8217;s views, in the form of various civil rights campaigns that have taken place through the ages.  I certainly agree that we should be taking heart from the courage of those people, and I don&amp;#8217;t disagree that there are many issues that we need to face as a global society.  However, I&amp;#8217;m not very good at being inspired by famous people, because I find it so easy to classify them as &amp;#8220;superhumans&amp;#8221;, whose very feet I am not worthy to lick, if only because they&amp;#8217;d probably have me arrested.  (Another societal norm you should be glad we have.)  My brother, on the other hand?  I can definitely assure you that he&amp;#8217;s not a superhuman, lovely though he may be, and that makes it a lot easier to learn from him when he does something&amp;nbsp;awesome.&lt;/p&gt;
&lt;p&gt;I guess the upshot of this is that I&amp;#8217;m very proud of him.  I&amp;#8217;d tell him this, but he&amp;#8217;d stare at me blankly before hitting me, or stealing my seat in the car, or some other expression of the mutual bond of fraternal love and friendship that we share.  So instead, you all get to read this, which I&amp;#8217;m sure had opened up your eyes considerably, or your money back.  And hopefully I&amp;#8217;ll be a bit bolder when it comes to doing things that don&amp;#8217;t necessarily fit in with my societal&amp;nbsp;norms.&lt;/p&gt;</summary></entry><entry><title>On Doctor Who and Cosmic Harmony</title><link href="https://mrjohz.github.io/posts/2013/Nov/25/on-doctor-who-and-cosmic-harmony/" rel="alternate"></link><updated>2013-11-25T11:01:51+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-11-25:posts/2013/Nov/25/on-doctor-who-and-cosmic-harmony/</id><summary type="html">&lt;p&gt;Doctor Who is 50 years old as of two days ago, and the celebrations have been going strong.  From documentaries on the life of the First Doctor, William Hartnell, to guest lectures on time travelling science by Brian Cox, and of course the grand event, the 50th Anniversary Special Episode.  All very exciting,&amp;nbsp;really.&lt;/p&gt;
&lt;p&gt;And, as with any big celebration, it is natural for people to be rather profuse in their congratulations of the show.  As a vast array of celebrities from the most minor to the most major, including a worrying number of teen boy bands, queued up to express admiration for Matt Smith&amp;#8217;s hair, it was perhaps expected that some people would push the boundaries of tripe to truly unimaginable&amp;nbsp;levels.&lt;/p&gt;
&lt;p&gt;As a fairly committed fan of Doctor Who, and a much, much more committed fan of my own voice, I thought I should take a quick look at some of this tripe.  After all, a lot of it was spouted by Americans, who just don&amp;#8217;t understand the British way of absolute stoicism in the face of all emotion.  When discussing such British classics as Doctor Who, any sense of feeling or passion should have been drained away a long time ago.  Really, the amount of meaning in many comments on the show would disappointment to my eyes, if disappointment were not too emotive a feeling to actually&amp;nbsp;feel.&lt;/p&gt;
&lt;p&gt;However, in my attempt to overanalyse these overanalyses, I realised something worryingly deep and meaningful about myself.  Well, I didn&amp;#8217;t, I just say that.  But I did realise that Doctor Who is a damn good television show.  Sure there&amp;#8217;s some stuff that&amp;#8217;s really rather over the top.  I direct this particularly at the 12-year-old American featured on the Doctor Who Afterparty who was about to get married.  His comments were really worryingly over the top.  Ultimately, though, I think we can all forgive those who get slightly carried away.  It is after all a relatively auspicious occasion: only a month and two days until&amp;nbsp;Christmas.&lt;/p&gt;
&lt;p&gt;So I&amp;#8217;m going to ignore these transgressions, and merely present to you a proper, emotionless congratulation of this long-running&amp;nbsp;show:&lt;/p&gt;
&lt;p&gt;Eh, it&amp;#8217;s done quite well to get this&amp;nbsp;far.&lt;/p&gt;</summary><category term="humour"></category><category term="doctor who"></category></entry><entry><title>Building a Pure-Javascript Theme Switcher</title><link href="https://mrjohz.github.io/posts/2013/Nov/11/building-a-pure-javascript-theme-switcher/" rel="alternate"></link><updated>2013-11-11T18:16:29+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-11-11:posts/2013/Nov/11/building-a-pure-javascript-theme-switcher/</id><summary type="html">&lt;p&gt;You might have noticed that you can change the theme of my blog.  I&amp;#8217;m quite sure I&amp;#8217;ve told you before that you can do this, but I&amp;#8217;m going to tell you again, because I&amp;#8217;m really proud of working out how to add this functionality, especially making it either work or fail gracefully on pretty much all browsers, and making it persist across sessions.  The exciting part for me is that this is entirely client-side, so it works on a static blog or website, which mine is.  I recognise that it&amp;#8217;s simple, easy, and my pride is entirely unwarranted, but dammit it makes me feel&amp;nbsp;good.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;ve spent today rewriting the code that does this to make it prettier, and more reusable.  For example, if you click on &lt;a href="javascript:void(0)" onclick="themeSwitcher.setStyle(-1);"&gt;this link&lt;/a&gt;, the entire theme will change to a different one.  It&amp;#8217;s also much easier to add new themes now, as there&amp;#8217;s only one place that they&amp;#8217;re&amp;nbsp;specified.&lt;/p&gt;
&lt;p&gt;So how does this all work?  Well, assuming you&amp;#8217;ve already got a document and a couple of stylesheets that you want to switch between, we&amp;#8217;ll start by defining a themeSwitcher&amp;nbsp;object.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here, we&amp;#8217;re simply creating a single object with an anonymous constructor function.  The constructor takes two arguments, the list of themes, and the default theme.  We store the list of themes directly, but instead of storing the defaultTheme as is (in a string format) we store it internally as an index.  We also need to set the currentTheme, which of course is the default theme by&amp;nbsp;default.&lt;/p&gt;
&lt;p&gt;Next we need to find out if there are any stylesheets already saved.  For this we need some sort of peristent storage.  I used localStorage, but there are other storage alternatives out there.  The other big contender that you might think about using is cookie storage.  There are three big differences between the two of these, for our uses at&amp;nbsp;least.&lt;/p&gt;
&lt;p&gt;Firstly, cookies are a pain to handle, whereas working with localStorage is a dream.  For me, this was the biggest reason for turning to localStorage.  Secondly, localStorage isn&amp;#8217;t entirely cross-browser.  While localStorage is available for about &lt;a href="http://caniuse.com/#feat=namevalue-storage" title="Can I Use: name-value Storage"&gt;90%&lt;/a&gt; of your users, if you think you&amp;#8217;re going to get a lot of traffic from older browsers that might be a consideration for you.  Thirdly, cookies are sent to the server.  This particular theme switcher is entirely client-side, so that&amp;#8217;s not necessary, but if you wanted to add some sort of server-side code that deals with the theme, you might want to think about using&amp;nbsp;cookies.&lt;/p&gt;
&lt;p&gt;However, for me localStorage seemed to be the best answer.  Of course, if we&amp;#8217;re using localStorage, we&amp;#8217;re going to need to ensure that localStorage exists.  If you&amp;#8217;ve already got &lt;a href="http://modernizr.com/" title="Modernizr - Feature detection"&gt;Modernizr&lt;/a&gt; installed, you should use that.  However, I didn&amp;#8217;t, and I didn&amp;#8217;t want to include a whole new library just to find out if I could use one feature, so I &lt;a href="https://github.com/Modernizr/Modernizr/blob/master/feature-detects/storage/localstorage.js" title="The localStorage test in Modernizr's source"&gt;used the source&lt;/a&gt;, and borrowed the test that Modernizr used.  This is what it looks&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// Assume that localStorage doesn&amp;#39;t&lt;/span&gt;
                         &lt;span class="c1"&gt;// work until proven otherwise&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Do a test&lt;/span&gt;
    &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Test failed&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Beautiful.&lt;/p&gt;
&lt;p&gt;Now if localStorage exists, that still doesn&amp;#8217;t mean that there&amp;#8217;s anything saved there.  The stuff that&amp;#8217;s saved there could also be complete gobbledygook.  If you can, have a look at what localStorage saves on this site.  (On Chrome, press Ctrl-Shift-i, go to &amp;#8220;Resources&amp;#8221;, and &amp;#8220;Local Storage&amp;#8221;.)  Edit it to something that isn&amp;#8217;t &amp;#8220;dark&amp;#8221; or &amp;#8220;lite&amp;#8221;, reload the page, and you&amp;#8217;ll see that the site automatically uses the &amp;#8220;dark&amp;#8221; theme.  That&amp;#8217;s because the alternative would be to load no stylesheet at all, and I really don&amp;#8217;t want that to&amp;nbsp;happen.&lt;/p&gt;
&lt;p&gt;To check if the value saved is an acceptable value, the easiest thing we can do is find out if it&amp;#8217;s in the array of themes that was passed into the constructor.  The best way to do this is &lt;code&gt;Array.prototype.indexOf&lt;/code&gt;, which works on most browsers, but not all.  Unfortunately, there are browsers that implement localStorage and not indexOf, so we need to write our own indexOf function for those cases.  I based mine on the &lt;a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Compatibility" title="Array.prototype - Mozilla docs"&gt;Mozilla sample implementation&lt;/a&gt;, minified it because it was useless and ugly, and added it to the top of the script.  Note that this implementation doesn&amp;#8217;t modify the Array&amp;nbsp;prototype.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;indexOf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;call&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="nx"&gt;arguments&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))}&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;===&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// Get the theme stylesheet, and check that it exists&lt;/span&gt;
    &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;theme-stylesheet&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// Note shim!&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So now themeSwitcher is an object that contains a list of all possible themes, the current theme, the default theme, and a flag that tells us if localStorage exists or not.  That&amp;#8217;s all very useful, but none of it actually changes the theme.  Indeed, we haven&amp;#8217;t even installed a theme on the page.  This theme switching system still requires a bit of&amp;nbsp;work.&lt;/p&gt;
&lt;p&gt;Firstly, let&amp;#8217;s add a function that writes the current theme to the document.  There are multiple ways of doing this, and some are more idiomatic and beautiful than others, but since all we&amp;#8217;re actually doing is writing a single line of &lt;span class="caps"&gt;HTML&lt;/span&gt;, I&amp;#8217;ve opted for &lt;code&gt;document.write&lt;/code&gt;.  Sure, you should probably build an element, and append it somewhere to the &lt;span class="caps"&gt;DOM&lt;/span&gt;, but I&amp;#8217;m lazy, and that feels like way too many lines of&amp;nbsp;code.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;  indexOf function&lt;/span&gt;
&lt;span class="cm"&gt;    ...&lt;/span&gt;
&lt;span class="cm"&gt;  constructor statements &amp;amp; test for localStorage&lt;/span&gt;
&lt;span class="cm"&gt;  */&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;writeStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// remember that currentTheme is an index, not a theme name&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="c1"&gt;// Modify the html here as you please.&lt;/span&gt;
    &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;link id=&amp;quot;main-theme&amp;quot; href=&amp;quot;/static/css/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot; /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I&amp;#8217;m creating a function to do this, because that&amp;#8217;s the way that feels most idiomatic to me.  (This is probably ironic, considering the previous paragraph.)  You could just do the &lt;code&gt;document.write&lt;/code&gt; as a statement within the constructor, but this means that later you&amp;#8217;ll have less control over when and where you place the&amp;nbsp;link.&lt;/p&gt;
&lt;p&gt;The other thing that we need is a way to change the themes once the document is loaded.  After all, expecting the user to reload the page every time they change the theme is a bit much to ask, don&amp;#8217;t you think?  The way I chose to do this was by writing two private &lt;code&gt;_setStyle&lt;/code&gt; function, and then defining one of them based on whether localStorage existed.  You could use an if-statement, and test on the &lt;code&gt;lsExists&lt;/code&gt; attribute, but why bother when the try/catch statement already divides flow into two sections for you to&amp;nbsp;use?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;  indexOf function&lt;/span&gt;
&lt;span class="cm"&gt;    ...&lt;/span&gt;
&lt;span class="cm"&gt;  constructor statements&lt;/span&gt;
&lt;span class="cm"&gt;  */&lt;/span&gt;

  &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="cm"&gt;/* get theme stylesheet */&lt;/span&gt;

    &lt;span class="c1"&gt;// _setStyle if localStorage exists&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_setStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="c1"&gt;// check that the theme really does exist&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="c1"&gt;// Get the URL of the link, and change it to the URL&lt;/span&gt;
      &lt;span class="c1"&gt;// of the new link.  This assumes that all the css&lt;/span&gt;
      &lt;span class="c1"&gt;// sheets are sitting in the same directory.  It also&lt;/span&gt;
      &lt;span class="c1"&gt;// assumes that only one css sheet is needed to define&lt;/span&gt;
      &lt;span class="c1"&gt;// a theme.  You can modify this if that isn&amp;#39;t the case.&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;main-theme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

      &lt;span class="c1"&gt;// Make sure we save the new theme name so that&lt;/span&gt;
      &lt;span class="c1"&gt;// the choice persists across sessions.&lt;/span&gt;
      &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pillbox-theme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// _setStyle if localStorage does not exists&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_setStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="c1"&gt;// the style will always be the current theme,&lt;/span&gt;
      &lt;span class="c1"&gt;// which will always be the default theme.&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;

      &lt;span class="c1"&gt;// Still write the new theme into the document,&lt;/span&gt;
      &lt;span class="c1"&gt;// just in case something has gone horribly wrong.&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;main-theme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;


  &lt;span class="cm"&gt;/* writeStyle function */&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can now start playing with things in your browser.  Assuming you&amp;#8217;ve got all your stylesheets in the right place, and a basic &lt;span class="caps"&gt;HTML&lt;/span&gt; layout, insert this code at the top of the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; brackets.  Then open up a development console and start calling &lt;code&gt;themeSwitcher._setStyle&lt;/code&gt; with various values.  Notice that you can only use indices to specify which theme you want.  Let&amp;#8217;s change that.  When we make our public setStyle function, we want to also be able to specify the string name of the css file.  I also want there to be a way to call it without specifying the theme, and let it toggle between&amp;nbsp;themes.&lt;/p&gt;
&lt;p&gt;To do this, we&amp;#8217;re going to need an algorithm that can take a string, integer, or null input, and return the index of the theme that best matches the description.  Now that sounds like a fairly useful algorithm to use, so in the interests of &lt;span class="caps"&gt;DRY&lt;/span&gt;, let&amp;#8217;s implement it as a new function, &lt;code&gt;themeSwitcher.getStyle&lt;/code&gt;, then add &lt;code&gt;themeSwitcher.setStyle&lt;/code&gt; on top of&amp;nbsp;it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="cm"&gt;/*&lt;/span&gt;
&lt;span class="cm"&gt;  indexOf function&lt;/span&gt;
&lt;span class="cm"&gt;    ...&lt;/span&gt;
&lt;span class="cm"&gt;  constructor statements&lt;/span&gt;
&lt;span class="cm"&gt;  */&lt;/span&gt;

  &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="cm"&gt;/* localStorage exists _setStyle implementation */&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="cm"&gt;/* localStorage doesn&amp;#39;t exist _setStyle implementation */&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="cm"&gt;/* writeStyle function */&lt;/span&gt;

  &lt;span class="c1"&gt;// public getStyle method&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Firstly, check if stylesheet is undefined or null.&lt;/span&gt;
    &lt;span class="c1"&gt;// In this case we&amp;#39;ll return the current theme.&lt;/span&gt;
    &lt;span class="c1"&gt;// This allows us to use themeSwitcher.themes[themeSwitcher.getStyle()]&lt;/span&gt;
    &lt;span class="c1"&gt;// to find out the current theme.&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;undefined&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// Next, stylesheet could be an index.  Return either the index,&lt;/span&gt;
    &lt;span class="c1"&gt;// or if index is invalid, the current theme.&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;
               &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;   &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// Otherwise, assume stylesheet is the name of a style.&lt;/span&gt;
    &lt;span class="c1"&gt;// If it isn&amp;#39;t, then it won&amp;#39;t be in the list of themes,&lt;/span&gt;
    &lt;span class="c1"&gt;// so just return the current theme.&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="c1"&gt;// public setStyle method&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// get the style index using getStyle&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;// if the stylesheet is the same as the current&lt;/span&gt;
    &lt;span class="c1"&gt;// stylesheet, toggle the stylesheet to the next one&lt;/span&gt;
    &lt;span class="c1"&gt;// in the list of themes.&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// Use whichever private _setStyle function was defined&lt;/span&gt;
    &lt;span class="c1"&gt;// to set the style of the page.&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_setStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The main theme switching mechanism is now pretty much almost done.  Unfortunately, unless the user plays around with their development console, they&amp;#8217;re not going to be able to change much.  This is where we need to add an element on the page that actually allows the user interface to work.  I&amp;#8217;ve implemented this here in the form of a &lt;code&gt;select&lt;/code&gt; drop-down choice form element, but of course you can edit and play with this code as much as you&amp;nbsp;want.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="cm"&gt;/* initialisation, writeStyle, getStyle and setStyle definitions */&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;elementID&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Append our switcher to #elementID&lt;/span&gt;
    &lt;span class="nx"&gt;elem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;elementID&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="c1"&gt;// We&amp;#39;re using a select element&lt;/span&gt;
    &lt;span class="nx"&gt;switcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;theme-switcher-select&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;// Iterate through the themes, and append them as options&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;theme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="nx"&gt;option&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;option&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;theme&lt;/span&gt;
      &lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createTextNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;theme&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

      &lt;span class="c1"&gt;// The current theme should be selected&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selected&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;};&lt;/span&gt;

    &lt;span class="c1"&gt;// When a new option is selected, call our setStyle function&lt;/span&gt;
    &lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onchange&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;theme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectedIndex&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;theme&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// Append to the document&lt;/span&gt;
    &lt;span class="nx"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And voila, a complete client-side theme switching solution.  How do you use this?  Well, the above definition should go in your &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; section in a &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag.  Then, immediately afterwards, you should call &lt;code&gt;themeSwitcher.writeStyle()&lt;/code&gt;.  Now the rest of your page can load, with the correct stylesheet enabled.  In the place where you want the theme-switching interface, create a container element with an id, then immediately below that, in script tags, call &lt;code&gt;themeSwitcher.addSwitcher(elementID)&lt;/code&gt;, where elementID is of course the id of the container element.  Check out the source code of this page to see it in action.  I&amp;#8217;ve minified the function definition, but it works exactly the&amp;nbsp;same.&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s the complete&amp;nbsp;listing.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themeSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;indexOf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;call&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;arguments&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))}&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;===&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;theme-stylesheet&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_setStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;main-theme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pillbox-theme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;lsExists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_setStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;main-theme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="nx"&gt;link&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;splits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;writeStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;link id=&amp;quot;main-theme&amp;quot; href=&amp;quot;/static/css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;styleName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot; /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;undefined&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;
                 &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;   &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setStyle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;stylesheet&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_setStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addSwitcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;elementID&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;elem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;elementID&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;switcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;theme-switcher-select&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;theme&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;themes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="nx"&gt;option&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;option&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;theme&lt;/span&gt;
      &lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createTextNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;theme&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;currentTheme&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selected&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onchange&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
      &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectedIndex&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="nx"&gt;themeSwitcher&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="nx"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;switcher&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;})([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet2.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;stylesheet1.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="coding"></category><category term="javascript"></category></entry><entry><title>Old News</title><link href="https://mrjohz.github.io/posts/2013/Nov/02/old-news/" rel="alternate"></link><updated>2013-11-02T13:32:03+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-11-02:posts/2013/Nov/02/old-news/</id><summary type="html">&lt;p&gt;It has come to my attention recently that I am very much out of the loop when it comes to the news.  As someone who used to obsessively spend their lunch hour shouting excitedly about the latest national policies at anyone who would listen, and a number of people who really wished they didn&amp;#8217;t have to listen, this is all a bit weird, and I&amp;#8217;m honestly slightly worried about it.  Even the things that should excite me beyond words have failed to catch my interest recently.  I&amp;#8217;m vaguely aware of nuclear power coming back to the &lt;span class="caps"&gt;UK&lt;/span&gt;.  There&amp;#8217;s something weird happening to GCSEs.  I can feel some remnants of old enthusiasm stirring up in me, but if I&amp;#8217;m honest it&amp;#8217;s not stirring up very&amp;nbsp;far.&lt;/p&gt;
&lt;p&gt;So, to rectify this, I have decided to run my expert eye over some of the recent news, and really find out what&amp;#8217;s happening.  And, because my entirely uninformed commentary will almost certainly be amazingly insightful, I thought I probably ought to share it with you, because that&amp;#8217;s what good friends and narcissistic bloggers&amp;nbsp;do.&lt;/p&gt;
&lt;p&gt;I started this post thinking that the &lt;a href="http://www.bbc.co.uk/news/world-us-canada-24773025"&gt;&lt;span class="caps"&gt;LA&lt;/span&gt; airport shooting&lt;/a&gt; would be the biggest piece of news for today, but on the &lt;span class="caps"&gt;BBC&lt;/span&gt; it&amp;#8217;s been relegated to first primary article in the &amp;#8220;and in other news&amp;#8221; section, with a bit of footage making the &amp;#8220;Watch/Listen&amp;#8221; section, so apparently that&amp;#8217;s not all that interesting.  After all, only one person died, and they&amp;#8217;ve already caught the killer, so is it much more than just another &amp;#8220;Only in America&amp;#8221; story?  I mean, I could go on a bit of a rant about how terrible the gun culture is in America, but a foreigner can&amp;#8217;t tell Americans how to live their lives, even if they are living them wrong, so I guess we&amp;#8217;ll just skip this&amp;nbsp;altogether.&lt;/p&gt;
&lt;p&gt;In fact, the &lt;span class="caps"&gt;BBC&lt;/span&gt;&amp;#8217;s top story is that &lt;a href="http://www.bbc.co.uk/news/world-asia-24776363"&gt;Hakimullah Mehsud has been killed by a drone&lt;/a&gt;.  That name doesn&amp;#8217;t actually ring any bells, but I will assume this is because of how out of the loop I am.  This is somewhat of an important development, as this man is apparently leader of the Pakistani Taliban, and the power vacuum may lead to the rise of a leader who will more readily submit to negotiations.  I seem to remember that my old, news-reading self would have seen this as another sign that the war on organised terror is over, and that we now need to turn to our own homes to sort out the problems of hate-crime and racial tension, rather than continually blame an &amp;#8220;enemy out there&amp;#8221;.  Unfortunately, my new self feels rather apathetic to this sort of stuff.  After all, this is a war that America is fighting, not the &lt;span class="caps"&gt;UK&lt;/span&gt;.  And it&amp;#8217;s happening in Pakistan, which also isn&amp;#8217;t the &lt;span class="caps"&gt;UK&lt;/span&gt;.  And this &amp;#8220;Taliban&amp;#8221; place doesn&amp;#8217;t sound like it&amp;#8217;s in the &lt;span class="caps"&gt;UK&lt;/span&gt; either, so why are we so excited about&amp;nbsp;it?&lt;/p&gt;
&lt;p&gt;The second story is about a &lt;a href="http://www.bbc.co.uk/news/uk-24779908"&gt;Mr Paul Gambaccini&lt;/a&gt;, and how he&amp;#8217;s clearly an evil paedophile like that nasty Saville bloke, and Rolf Harris, and probably Bruce Forsyth, I mean, just look at him, he must be in on it, right?  Now I recognise the name, but I&amp;#8217;m not entirely sure where from.  I&amp;#8217;ve googled for pictures of him, and the face isn&amp;#8217;t ringing any bells, although there are lots of pictures of Jimmy Saville there, proving that he must be a paedophile.  I&amp;#8217;m guessing it&amp;#8217;s from listening to Radio Four, which is something I&amp;#8217;m not supposed to admit to doing, but used to quite enjoy&amp;nbsp;anyway.&lt;/p&gt;
&lt;p&gt;To be honest, every time this Operation Yewtree thing comes around, I feel less inclined to be outraged.  It&amp;#8217;s quite clear that there was a culture at the time in certain organisations that just ignored sexual harassment as a thing.  It&amp;#8217;s great that we&amp;#8217;re finally getting the perpetrators of these crimes to own up to the things they&amp;#8217;ve done, but, apart from simply providing justice to those that deserve it, the ultimate question it raises is whether that sort of thing could happen again.  Is today&amp;#8217;s lad culture really that far removed from Saville&amp;#8217;s big-shot world, where fame and a cocky attitude could get you out of almost&amp;nbsp;anything?&lt;/p&gt;
&lt;p&gt;It&amp;#8217;s at this point that I turn to the more important news stories, those contained within the science/technology/environment sections, and it turns out the news is actually genuinely exciting.  Not just one, but &lt;em&gt;two&lt;/em&gt; fusion stories!  Firstly, America&amp;#8217;s National Ignition Facility (&lt;span class="caps"&gt;NIF&lt;/span&gt;) has &lt;a href="http://www.bbc.co.uk/news/science-environment-24429621"&gt;done the impossible&lt;/a&gt;, and got more energy out of a fusion event than it has put in, for a given value of putting energy in.  &lt;span class="caps"&gt;NIF&lt;/span&gt; have been attempting to do fusion by shining lasers at pellets of hydrogen, and waiting for them to explode.  Now, or at least in late September, they&amp;#8217;ve finally managed to get more energy out of the pellet than they&amp;#8217;ve put into the pellet, although due to inefficiencies everywhere, this doesn&amp;#8217;t account for the energy they put into the laser.  So we&amp;#8217;re not quite there yet, but we might be in 20-30 years&amp;#8217; time.&amp;nbsp;Maybe.&lt;/p&gt;
&lt;p&gt;The second fusion story is of course the more important one, because it involves the One True Path to fusion, the &amp;#8220;tokamak&amp;#8221; reactor.  Now I&amp;#8217;m quite biased in this area, having grown up not too far from the current European experiment, known as &lt;span class="caps"&gt;JET&lt;/span&gt;.  However, as I&amp;#8217;ve already described the American attempt in a pithy and unscientific manner, I feel I should do the same for tokamaks.  Essentially, the idea is to get a load of very hot hydrogen, and spin it in a circle until it does something exciting.  So what have these people been doing that&amp;#8217;s so newsworthy?  Well, they&amp;#8217;ve finally got round to &lt;a href="http://www.bbc.co.uk/news/science-environment-23408073"&gt;receiving the inital components with which they can build the new &lt;span class="caps"&gt;ITER&lt;/span&gt; reactor&lt;/a&gt;.  Yes, that&amp;#8217;s right, the Europeans are almost about to start building a the outline of a new reactor,&amp;nbsp;maybe.&lt;/p&gt;
&lt;p&gt;Fusion is really cool.  Well, it isn&amp;#8217;t, it requires ridiculously high temperatures and pressures, but you know what I mean.  The problem is that fusion just isn&amp;#8217;t happening any time soon.  It will work, eventually, it&amp;#8217;s just that realistically scientists aren&amp;#8217;t in a position to promise anything at any sensible timescale, so they make overconfident claims, and the phrase &amp;#8220;twenty years&amp;#8221; becomes synonymous with &amp;#8220;never&amp;#8221;.  However, we really need to keep on pushing for it, because it&amp;#8217;s&amp;nbsp;awesome.&lt;/p&gt;
&lt;p&gt;And finally, we come to a lovely local news story that not only includes a baby and an animal, but also manages to make you disgusted with your neighbours, and utterly amazed at the goodness of humanity.  Yes, that&amp;#8217;s right, &lt;a href="http://www.bbc.co.uk/news/uk-england-birmingham-24770596"&gt;an abandoned baby has been named after the dog owned by the walker who found her&lt;/a&gt;.  Doesn&amp;#8217;t the story feels so&amp;#8230;  &lt;em&gt;local&lt;/em&gt;?  It&amp;#8217;s the way that a single sentence can neatly sum up almost every facet of this simple and easy-to-digest piece of news.  It&amp;#8217;s the way that this doesn&amp;#8217;t actually affect your life, or the life of the country in any significant way, but manages to brighten your day, and make you reflect on all the horrible things in the world at the same time.  It&amp;#8217;s the way there&amp;#8217;s interviews with people whose only relevant job description is &amp;#8220;dog walker&amp;#8221;.  It&amp;#8217;s the sort of thing local news was made&amp;nbsp;for.&lt;/p&gt;
&lt;p&gt;So thank you, reader, for allowing me to take this journey through the world&amp;#8217;s current state of affairs.  I&amp;#8217;ve almost enjoyed it, actually.  It&amp;#8217;s nice to once again be able to pass comment in a sarcastic way, get excited about small things that don&amp;#8217;t massively make a difference to my life, and generally attempt to appear knowledgeable despite my utter absence of authority on the subject.  In fact, I might think about following the news slightly more now.  In fact, I might even shout angrily at you about it, if you&amp;#8217;ll be so kind as to let&amp;nbsp;me&amp;#8230;&lt;/p&gt;</summary><category term="news"></category></entry><entry><title>A Splash of Colour</title><link href="https://mrjohz.github.io/posts/2013/Oct/20/a-splash-of-colour/" rel="alternate"></link><updated>2013-10-20T13:12:44+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-10-20:posts/2013/Oct/20/a-splash-of-colour/</id><summary type="html">&lt;p&gt;The aim is that this will be my last post about my blog for a while, but I just wanted to point out some of the interesting features, because I think that&amp;#8217;s what one does on technology-related blogs, and really I just want to fit in an be like the other cool guys.  Dammit, I&amp;#8217;m a terrible&amp;nbsp;person.&lt;/p&gt;
&lt;p&gt;As mentioned before, this is a &lt;a href="http://blog.getpelican.com/"&gt;Pelican&lt;/a&gt; blog.  Excuse the mild ideosyncracies of the documentation (particularly that if you click on a link, you will &lt;em&gt;never&lt;/em&gt; be able to get back to the main page), it&amp;#8217;s actually quite a nice system.  Pelican is a static-site generator, in the style of all the other static-site generators that I&amp;#8217;m sure we could name between us, but with a few nice touches of it&amp;#8217;s own.  For example, unlike Jekyll and associated software, it only requires a directory of posts and pages, as opposed to a directory containing all the parts of a blog.  It&amp;#8217;s relatively well supported, particularly among the French-speaking community.  It&amp;#8217;s also written in Python, which, as a Pythonista first and foremost, means I can read the code and actually understand most of what it&amp;#8217;s&amp;nbsp;doing.&lt;/p&gt;
&lt;p&gt;Secondly, you&amp;#8217;ll notice the theme.  The theme is custom-built.  This is amazing.  My knowledge of &lt;span class="caps"&gt;CSS&lt;/span&gt; is approximately equal to my knowledge on the dietary habits of pregnant sperm whales.  Seriously, any good impressions you have of the styling of this site are more an indication of the power and ease-of-use of &lt;a href="http://lesscss.org/"&gt;less&lt;/a&gt; than my own ability.  Some interesting and exciting&amp;nbsp;things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;You can change the colour-scheme!  I know a number of people who have really strong preferences over light vs dark, so if you scroll to the bottom, you&amp;#8217;ll find a switcher that allows you to switch between light and dark.  Everything is entirely client-side, and the preference is saved in localStorage so your theme-choice will persist between sessions.  If you don&amp;#8217;t have either localStorage, or javascript in general, the page will load the dark theme by default, because dark is clearly the cooler&amp;nbsp;choice.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The theme includes a random quote of the page load.  This is the second &amp;#8216;bubble&amp;#8217; that appears on the main page.  The quotes are taken from the &lt;span class="caps"&gt;RANDOMQUOTES&lt;/span&gt; pelican option, and then every time the page loads, a javascript function writes out a div containing a random quote.  Obviously, if there is no javascript, the div never gets written at all, and so the page still runs&amp;nbsp;beautifully.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The theme is largely &lt;span class="caps"&gt;XKCD&lt;/span&gt;/1271 compliant.  For those that don&amp;#8217;t obsessively follow the famous webcomic, &lt;a href="http://xkcd.com/1271"&gt;comic #1271&lt;/a&gt; recently described the habit of highlighting text while browsing websites, and then feeling good when the highlighted text makes a beautiful shape.  As someone who suffers from a similar compulsion (for reference, I consider option 4 of Randall&amp;#8217;s list to be the only viable option) I spent last night redesigning parts of the article layout so that when one highlights text in Chrome, there are no longer any horrible&amp;nbsp;overhangs.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are still a few things that I haven&amp;#8217;t quite sorted, that I still need to work on.  I&amp;#8217;ve only really been concentrating on the index template and the pages template, so it might be that other pages look slightly more broken.  When I get comments, you can tell me about those pages.  Although first I really need to get a comments system in&amp;nbsp;place.&lt;/p&gt;
&lt;p&gt;The theme is open source, obviously, and is available &lt;a href="https://github.com/MrJohz/pillbox-theme"&gt;on GitHub&lt;/a&gt; as the Pillbox theme.  Feel free to fork&amp;nbsp;away.&lt;/p&gt;</summary><category term="meta"></category></entry><entry><title>The Truth of the Matter</title><link href="https://mrjohz.github.io/posts/2013/Oct/18/the-truth-of-the-matter/" rel="alternate"></link><updated>2013-10-18T01:10:00+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-10-18:posts/2013/Oct/18/the-truth-of-the-matter/</id><summary type="html">&lt;p&gt;You may have noticed something about my blog over the past few days, and that is that I have been lying.  Lying over the internet is truly one of the most heinous of crimes, and yet it has been committed right in front of your eyes.  And now I can only do the rightful thing and admit to the hideous falsity that I have&amp;nbsp;constructed.&lt;/p&gt;
&lt;p&gt;This site was not built with&amp;nbsp;Octopress.&lt;/p&gt;
&lt;p&gt;I can imagine your shock, but I hope you will at least grant me time to explain myself.  When I started putting together my new, exciting blog, I had originally planned for it to be a Wordpress blog.  I&amp;#8217;d find some nice plugins, get myself a nice theme, and, hey presto, a beautiful, dynamic blog that would not only be simple to browse, but easy to edit and modify.  But then I actually got Wordpress, and somehow it didn&amp;#8217;t feel right.  There wasn&amp;#8217;t a nice syntax highlighting module, and the markdown abilities weren&amp;#8217;t the impressive beasts that I have become accustomed to.  Additionally, it just lacked the customisability I wanted.  I guess if I knew &lt;span class="caps"&gt;PHP&lt;/span&gt; I&amp;#8217;d be able to play a lot more with it, but in the end, I said no to&amp;nbsp;Wordpress.&lt;/p&gt;
&lt;p&gt;Of course, this lead me on a search through the wilderness to find Octopress, that bastion of cool, Ruby-esque hip-ness.  I got on relatively well with Octopress, despite the fact that it didn&amp;#8217;t get on very well with me.  In the end, however, I was driven away by the fact that my posts were in some oddly-named folder hidden in a directory that I didn&amp;#8217;t know or care about.  The tribulations of making an Octopress post eventually outweighed the power and cool nature of Octopress.  This, however, was the point that I left you at, the point at which I left you with the now-erroneous impression that I use&amp;nbsp;Octopress.&lt;/p&gt;
&lt;p&gt;What do I use now, then?  Well, I wanted something written in a language I could understand.  Ruby was good, but Python was better.  I liked the idea of a static blog, but I didn&amp;#8217;t want to hunt down posts in odd folders, I wanted it to all look fairly obvious.  I wanted something that was simple enough that all I needed was a simple script to build, test, serve, and upload to my server, yet actually quite powerful underneath.  Thus, this blog is now hosted with &lt;a href="http://getpelican.com/"&gt;Pelican&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pelican is quite cool.  It does most of the things that Jekyll/Octopress do, but with a very heavy emphasis on &amp;#8220;articles&amp;#8221; or blog posts.  Like Octopress, it provides a quickstart script that sets most of your default settings, and builds your Makefiles/Fabfiles for you.  It should be noted that, for me at least, the Fabfile is broken in ways that confuse me completely, but the Makefile has worked like a dream.  It&amp;#8217;s based on markdown &lt;em&gt;and&lt;/em&gt; reStructedText.  It comes with an array of themes and plugins.  It&amp;#8217;s generally quite&amp;nbsp;impressive.&lt;/p&gt;
&lt;p&gt;Speaking of themes, you might have noticed that this blog has a new theme.  Sure, it should be obvious that getting new blogging software almost always precipitates getting a new theme, but this theme is special, because I built it.  Personally I am amazed.  I ask dearly that no-one who knows anything about web design look at the css files, as they are a hideous mess put together using less, random snippets from stackoverflow, and moments of frenzied inspiration.  I might minify them just so that people can&amp;#8217;t see how bad my &lt;span class="caps"&gt;CSS&lt;/span&gt;-fu&amp;nbsp;is.&lt;/p&gt;
&lt;p&gt;However, it seems to work, both here on my laptop, and also on my all-important phone.  It&amp;#8217;s pretty much all simple css, so it should run pretty quickly.  I have a vague plan to add extra colour-schemes, and then allow the user to select different themes, and then save preferences client-side, and all sorts of exciting things like that, but apart from that I&amp;#8217;ve tried to limit my excitement for overly-complex javascript scripts to the random-quote generator at the top of the main page.  (Scroll up and refresh the page to see the exciting quotes!  I spent, like, thirty seconds on them!  They&amp;#8217;re my best&amp;nbsp;work!)&lt;/p&gt;
&lt;p&gt;Anyway, to conclude: Welcome to what will almost certainly hopefully maybe my new blog!&amp;nbsp;Perhaps.&lt;/p&gt;</summary><category term="meta"></category><category term="pelican"></category><category term="octopress"></category></entry><entry><title>“OMG Elixir: Functional Ruby with the Power of Erlang”</title><link href="https://mrjohz.github.io/posts/2013/Oct/02/omg-elixir/" rel="alternate"></link><updated>2013-10-02T23:49:00+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-10-02:posts/2013/Oct/02/omg-elixir/</id><summary type="html">&lt;p&gt;Recently, I found Elixir.  It just appeared in front of me.  Specifically, &lt;a href="http://learnxinyminutes.com/" title="Learn X in Y Minutes"&gt;Learn X in Y Minutes&lt;/a&gt; appeared before me, and so I read.  About a quarter of the way down lay a link to a short page entitled &amp;#8220;Elixir&amp;#8221;.  This should have been a horrible language.  It was functional, and I have always been an object-oriented programmer before.  It was based on Erlang, a language with &lt;a href="http://damienkatz.net/2008/03/what_sucks_abou.html" title="What Sucks About Erlang"&gt;syntax as bad as Lisp&amp;#8217;s, but without the redeeming powers of Lisp&lt;/a&gt;.  It had a syntax based on Ruby, which I hate&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt;.  All in all, I should have switched off&amp;nbsp;there.&lt;/p&gt;
&lt;p&gt;But I didn&amp;#8217;t.  I carried on reading.  I found a handful of blog posts.  I started to read into Erlang and the &lt;span class="caps"&gt;OTP&lt;/span&gt;.  I found Elixir at the start of a week-long camping holiday.  By the end of the week, before I had had the chance to write a single line of code, I was hooked.  Why?  Well, I still don&amp;#8217;t know, but I might as well try and explain my reasoning to&amp;nbsp;you.&lt;/p&gt;
&lt;p&gt;Firstly, Elixir is functional, and this is cool.  Sure, &lt;span class="caps"&gt;OOP&lt;/span&gt; is awesome, and I love it when it&amp;#8217;s around, but functional programming has an elegence to it that just isn&amp;#8217;t matched by building up big objects.  Indeed, there are many programs where object-oriented programming just doesn&amp;#8217;t make much sense.  Take a module designed to read json.  In Python, the standard way would be to have a class, say the JSONDecoder class, and let that do all the work.  Indeed, in Python this is a remarkably sensible system.  The module&amp;#8217;s user is normally presented with simple functions for most of their needs, but they can also subclass JSONDecoder whenever they need to, and add onto it as they please.  It&amp;#8217;s how you&amp;#8217;d do it in Python, but is it really how you do it&amp;nbsp;conceptually?&lt;/p&gt;
&lt;p&gt;My mental image of decoding &lt;span class="caps"&gt;JSON&lt;/span&gt; is definitely a function.  I give it &lt;span class="caps"&gt;JSON&lt;/span&gt; string input, and it comes out with a structure I can use in my code.  This function then needs to tokenise my input, which is a job for a function.  Each set of tokens needs to be recompiled back into a native data structure.  Each step is a function, taking an input, returning an output.  Decoding &lt;span class="caps"&gt;JSON&lt;/span&gt;, along with a large number of other tasks, is a functional&amp;nbsp;task.&lt;/p&gt;
&lt;p&gt;Sure, there are other tasks for which the object-oriented structure is perfect.  When I want to model a real-life object then it&amp;#8217;s natural to have an object with attributes and methods, but knowing a functional language will definitely give you the tools to use when you need a different&amp;nbsp;system.&lt;/p&gt;
&lt;p&gt;Secondly, Elixir is Erlang, and this is powerful.  A brief history lesson that you should &lt;a href="http://www.erlang.org/" title="The Erlang Homepage"&gt;follow&lt;/a&gt; &lt;a href="http://learnyousomeerlang.com/" title="Learn You Some Erlang (For Great Good)"&gt;up&lt;/a&gt; &lt;a href="http://en.wikipedia.org/wiki/Erlang_(programming_language)" title="Erlang (programming language) - Wikipedia"&gt;on&lt;/a&gt; because it&amp;#8217;s so interesting:  Erlang was designed by Erricson, the Swedish telecommunications company, as a language that would be suitable for their telephony systems.  It needed to be able to fix itself when it broke, update itself without breaking, be able to handle concurrency with ease and, because programmers should be able to program efficiently, it was designed to be a functional program, on the basis that functional programming would be easier for the&amp;nbsp;programmers.&lt;/p&gt;
&lt;p&gt;Erlang is an amazingly nifty language because of these things.  While benchmarks are useless, &lt;a href="https://gist.github.com/josevalim/1582864" title="Dynamo Benchmark"&gt;this one&lt;/a&gt; demonstrates one of the benefits of an Erlang background.  It&amp;#8217;s a test of various similar web frameworks, and it shows how the Elixir/Erlang-based one (Dynamo) is able to deal with concurrency straight out of the box.  As the writer&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2" rel="footnote"&gt;2&lt;/a&gt;&lt;/sup&gt; notes, the other options almost certainly support concurrency, but immediately, straight out of the box, and with such ease that it&amp;#8217;s sometimes said that processes are an Erlang developer&amp;#8217;s&amp;nbsp;objects.&lt;/p&gt;
&lt;p&gt;So Elixir builds on Erlang, and in a really nice way, too.  Leaving aside the syntax, which is by-and-large friendly and intuitive to use, there&amp;#8217;s all sorts of extras.  Take the standard libraries.  Erlang libraries are useful, but woefully inconsistent.  Some use zero-indexing, others start their indexing at 1.  When performing operations on structures such as lists, some functions will put the structure as the first argument, others as the structure.  Elixir&amp;#8217;s library is designed to standardise this.  Not only that, but when you do need an Erlang library, it&amp;#8217;s as easily accessible as any Elixir library, just using a slightly different&amp;nbsp;syntax.&lt;/p&gt;
&lt;p&gt;Thirdly, Elixir isn&amp;#8217;t Erlang, and this is a relief.  As I&amp;#8217;ve just said, Erlang did make mistakes, but Elixir has done a brilliant job of avoiding them.  Just one small example: Elixir comes with dictionaries built-in, as a list of tuples that can be accessed using the near-univeraslly standard bracket notation.  It&amp;#8217;s not all-powerful, but it&amp;#8217;s damn&amp;nbsp;useful.&lt;/p&gt;
&lt;p&gt;Or take records, which are the missing link between simple mappings and full-blown objects.  When you want to know exactly what types of data you&amp;#8217;re passing around, define yourself a record and use it.  Indeed, you can use it as if it were a built-in type by adding protocols, which allow for a very basic duck-typing system to form.  For a functional program, Elixir is very&amp;nbsp;object-oriented.&lt;/p&gt;
&lt;p&gt;And then there&amp;#8217;s the most powerful part of Elixir, the fact that it is written, by-and-large, in itself, using macros.  If Erlang is as painful to write as Lisp without the benefits of using macros, then Elixir is as powerful as Lisp with all her macro-based glory, but with all of the benefits of a syntax you want to write in.  Macros are designed to be used for anything, ranging from simple domain-specific languages (imagine the &lt;code&gt;get "url/route" do&lt;/code&gt; style used in Ruby-on-Rails or the task-specification format in a Rakefile) to directly adding your own constructs into the library.  One of the popular examples is the unit-testing system that&amp;#8217;s been included.  A macro is able to examine the code that&amp;#8217;s passed into it, allowing ExUnit to look at&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;a simple assertion&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;assert&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And interpret it in such a way as to be able to respond like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="n"&gt;adding&lt;/span&gt; &lt;span class="n"&gt;two&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;MathTest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;ExUnit.ExpectationError&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="ss"&gt;expected&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
     &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;equal&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
   &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It&amp;#8217;s not desperately showy or flashy, and you&amp;#8217;d be forgiven for wondering why this example gets mentioned so much, but it&amp;#8217;s actually a lot more involved than it seems.  The simple assertion macro is passed a length of code as a syntax tree, and it gets to evaluate it and understand it as it sees fit.  That&amp;#8217;s&amp;nbsp;powerful.&lt;/p&gt;
&lt;p&gt;This has been but a brief look at Elixir, and I&amp;#8217;d encourage you to try it out yourself sometime.  It&amp;#8217;s a language built entirely for developers, right down to the extensive build-tools that come packaged with it from the off.  A good starting point would be the &lt;a href="http://elixir-lang.org/getting_started/1.html" title="Elixir - Getting Started"&gt;getting started guide&lt;/a&gt; that you can see on the &lt;a href="http://elixir-lang.org/" title="Elixir Home"&gt;main website&lt;/a&gt;.  Of course you should always peruse the &lt;a href="http://elixir-lang.org/docs/master/" title="Elixir Docs"&gt;documentation&lt;/a&gt;.  There aren&amp;#8217;t many good tutorials on Elixir at the moment (it&amp;#8217;s not even four years&amp;#8217; old, and hasn&amp;#8217;t currently done a 1.0 release) but I&amp;#8217;d recommend &lt;a href="http://learnyousomeerlang.com/" title="Learn You Some Erlang (For Great Good)"&gt;Learn You Some Erlang (For Great Good)&lt;/a&gt; as a start, and, if you&amp;#8217;re willing to splash the cash, the &lt;a href="http://pragprog.com/book/elixir/programming-elixir" title="Programming Elixir - Pragmatic Programming"&gt;Pragmatic Programmers&lt;/a&gt; are putting together a book, and you can buy the beta-edition ebook and learn as it gets continually&amp;nbsp;updated.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;To be honest, I fully recognise that Ruby has some awesome things, and it&amp;#8217;s definitely a good and powerful language to know, but you know how there are some languages that, right down in your gut, you just &lt;em&gt;hate&lt;/em&gt;?  Yeah, I hate Ruby.  I love rubyists, though.  Hate the sin, love the sinner, right?&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text"&gt;[back]&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;Who admittedly just happens to be José Valim, the creator of Elixir, but shhhh, I&amp;#8217;ve already mentioned that benchmarks are rubbish, I&amp;#8217;m just demonstrating what this one actually tells us&amp;#8230;&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text"&gt;[back]&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary><category term="coding"></category><category term="elixir"></category></entry><entry><title>Hello, World 2.0</title><link href="https://mrjohz.github.io/posts/2013/Sep/30/hello-world-2-dot-0/" rel="alternate"></link><updated>2013-09-30T21:31:00+00:00</updated><author><name>Jonathan Frere</name></author><id>tag:mrjohz.github.io,2013-09-30:posts/2013/Sep/30/hello-world-2-dot-0/</id><summary type="html">&lt;p&gt;So I got a blog.  A second blog, to be precise.  Some of you might remember the &lt;a href="http://johz.wordpress.com/" title="Johz Blog"&gt;old blog&lt;/a&gt; on &lt;a href="http://wordpress.com/" title="Wordpress Home"&gt;wordpress.com&lt;/a&gt;.  You might also have noticed that I haven&amp;#8217;t blogged from there in over a year.  I managed to tell you all that I&amp;#8217;d arrived at University, and then I mysteriously went silent.  Well, now I&amp;#8217;m back, back with a vengeance, and also with hosting.  Yes,&amp;nbsp;hosting.&lt;/p&gt;
&lt;p&gt;At the time that I write this, I am using &lt;a href="http://www.webfaction.com" title="Web Faction Home"&gt;Web Faction&lt;/a&gt; for my hosting.  Why?  Well, it seemed to me like it was the most helpful.  There were docs on doing pretty much everything I wanted to do, with a healthy support base, and a generally hacker-oriented vision.  That appealed to me.  Then I managed to find a &lt;a href="http://slickdeals.net/f/5989592-webfaction-hosting-50-off-1yr-65-off-3yrs" title="Webfaction deals"&gt;code for 50% off hosting&lt;/a&gt;, and it suddenly seemed like the most sensible choice.  It&amp;#8217;s certainly not the cheapest provider out there, but I&amp;#8217;m hoping it&amp;#8217;ll turn out to be a good first&amp;nbsp;choice.&lt;/p&gt;
&lt;p&gt;More technical details abound.  I&amp;#8217;m currently hosting in Europe, because Europeans are cooler and more awesome, and my internet connection is poor enough that I need all the help I can get in improving the latency of my ssh connection.  This blog is produced using &lt;a href="http://www.octopress.org" title="Octopress Home"&gt;Octopress&lt;/a&gt;, which is lovely, and allows me to use Markdown, which I just love.  I&amp;#8217;m currently hunting down a nice theme for the blog, but I might have to end up making my own, and that would be bad.  No, seriously, it would be an affront to all your sensibilities, so if you&amp;#8217;ve found an awesome theme, please tell me about it.  It could save your life, although I have yet to work out&amp;nbsp;how.&lt;/p&gt;
&lt;p&gt;What sorts of things will you find on here other than a blog?  Well, as I have returned to &lt;a href="http://www.nationstates.net" title="NationStates Home"&gt;NationStates&lt;/a&gt;, expect a few &lt;span class="caps"&gt;NS&lt;/span&gt;-related apps to appear.  Additionally, I&amp;#8217;m planning on fixing up my &lt;span class="caps"&gt;IRC&lt;/span&gt; bot, K-Eight, and running him from this server.  Finally, I&amp;#8217;d like to get back to writing.  You might have read my old poems and prose on the WordPress blog.  If you haven&amp;#8217;t, please don&amp;#8217;t go back and look at them, they were awful.  But I&amp;#8217;ve got to confess, I really enjoyed being able to write, and a success in a short-story competition recently (well, half a year ago) and a few conversations with some creative friends have inspired me to try and revisit some of my old ideas.  So look out for that, maybe, if you&amp;#8217;re masochistic&amp;nbsp;enough.&lt;/p&gt;
&lt;p&gt;Anyway, for now I&amp;#8217;m going to go back to coding and thinking up new blog posts.  Again, if you know of a good Octopress theme, contact me somehow.  I&amp;#8217;ll get comments and an email address up soon, until then I recommend telepathy, sending a message in a bottle, or simply contacting me on &lt;span class="caps"&gt;IRC&lt;/span&gt;: &lt;a href="irc://irc.esper.net/johztestingchannel" title="#johztestingchannel on Esper.net"&gt;#johztestingchannel on Esper.net&lt;/a&gt;.  Bye for&amp;nbsp;now!&lt;/p&gt;</summary><category term="meta"></category></entry></feed>